<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administrativo</title>
    <link rel="icon" href="https://i.ibb.co/Q9Y51HN/administrador.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
    <!-- jQuery (necessary for DataTables) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- DataTables JS -->
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/fontawesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/solid.min.css">


    <style>
        /* Estilos generales */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #f4f4f9;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Contenedor general del contenido */
        .main-content {
            padding: 20px;
        }

        /* Contenedor de login centrado */
        #login-section {
            position: absolute; /* Permite posicionarlo */
            top: 50%; /* Centrado vertical */
            left: 50%; /* Centrado horizontal */
            transform: translate(-50%, -50%); /* Ajusta el centro real */
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            padding: 40px 30px;
            text-align: center;
            max-width: 400px;
            width: 100%;
            font-family: 'Arial', sans-serif;
        }

        /* Imagen del logo */
        #logo {
            width: 120px; /* Tamaño del logo */
            /*margin-bottom: ;*/
            max-width: 200px;  /* Tamaño máximo en ancho */
            max-height: 200px; /* Tamaño máximo en alto */
            width: auto;
            height: auto;

        }

        #login-section h2 {
            color: #0054a6; /* Azul corporativo */
            font-size: 1.8rem;
            margin-bottom: 20px;
            font-weight: bold;
        }

        /* Inputs de texto */
        #login-section input {
            width: 100%;
            padding: 12px 15px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #05050e;
            font-size: 1rem;
            color: #333;
            box-sizing: border-box;
            background-color:rgb(249, 249, 249) /* Fondo gris claro */
        }

        #login-section input:focus {
            outline: none;
            border: 2px solid #3735c9;
            background-color: #ffffff;
        }
        
        #login-section input:hover {   
            border: 2px solid #12428a;
            border-radius: 7px;
        }

        /* Botón de inicio */
        #login-section button {
            width: 100%;
            padding: 12px 15px;
            background: #0054a6;
            color: #ffffff;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            transition: background 0.3s ease;
        }

        /* Enlace para recuperar contraseña */
        #login-section a {
            display: block;
            margin-top: 15px;
            font-size: 0.9rem;
            color: #0054a6;
            text-decoration: none;
        }

        #login-section button:hover {
            background: #575757;
        }

        /* Spinner */
        #login-button .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #0054a6;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 0.8s linear infinite;
            margin: auto;
        }

        /* Animación del spinner */
        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        /* Estilos para el menú */
        .main-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: #007bff;
            padding: 10px;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }

        .main-menu.vertical {
            width: 60px; /* Ancho reducido para la versión vertical */
            flex-direction: column; /* Cambio a columna */
            top: 50%; /* Centrado verticalmente */
            transform: translateY(-50%);
            padding: 5px;
            justify-content: flex-start;
            left: 0; /* Asegurar que se alinee al lado izquierdo */
            z-index: 999;
            transition: left 0.3s ease; /* Animación para mover el menú */
        }


        .main-menu a,
        .logout-button {
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            border-radius: 5px;
            background-color: rgba(68, 68, 68, 0.3);
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            display: flex;
            align-items: center;
        }

        /* Los iconos (imagenes) */
        .menu-icon {
            width: 30px;
            height: 30px;
            margin-right: 10px; /* Espaciado entre la imagen y el texto */
            transition: transform 0.3s ease;
        }   

        /* Ocultar el texto cuando el menú está en la versión vertical */
        .main-menu.vertical .menu-text {
            opacity: 0; /* Hacer los iconos invisibles */
            transform: translateX(-50%); /* Ocultar parcialmente moviendo los iconos */
        }

        /* Al pasar el mouse por encima del menú, se mueve a la vista */
        .main-menu.vertical:hover {
            left: 0; /* Mostrar el menú completamente */
        }

        /* Ocultar texto cuando el menú esté en la versión vertical */
        .main-menu:not(.vertical) .menu-icon {
            opacity: 1; /* Hacer los iconos completamente visibles */
            transform: translateX(0); /* Mover los iconos a su posición normal */
        }

        /* Estilo de hover y selección de los enlaces y botones */
        .main-menu a:hover,
        .logout-button:hover {
            background-color: #007bff;
            box-shadow: none;
        }

        /* Estilo para los textos */
        .menu-text {
            display: none; /* Ocultar el texto en la versión vertical */
        }

        /* Estilo de los iconos en versión vertical */
        .main-menu.vertical .menu-icon {
            width: 20px; /* Reducir el tamaño de los iconos en versión vertical */
            height: 20px;
        }

        .main-menu a img {
            width: 30px;
            height: 30px;
            margin-right: 10px; /* Espaciado entre la imagen y el texto */
        }

        .main-menu a:hover img {
            transform: scale(1.2) !important; /* Aumentar ligeramente el tamaño del icono */
        }

        /* Estilo para mostrar texto en la versión horizontal */
        .main-menu:not(.vertical) .menu-text {
            display: inline-block;
            margin-left: 10px; 
        }

        /* Estilo para el botón de cerrar sesión */
        .logout-button img {
            width: 30px;
            height: 30px;
            margin-right: 10px;
        }

        .main-menu.vertical a img {
            width: 20px;  /* Reducir el tamaño de los iconos en versión vertical */
            height: 20px;
        }

        /* Resaltar sesión activa incluso sin hover */
        .main-menu a.active,
        .logout-button.active {
            background-color: #0056b3;
            box-shadow: 0 0 10px 2px rgba(0, 86, 179, 0.8);
            font-weight: bold; /* Resaltar el texto del enlace */
        }

        /* Estilo para el menú cuando el mouse entra */
        .main-menu:hover {
            background-color: #333;
        }

        /* Estilo para el botón de cerrar sesión */
        .logout-button:hover {
            background-color: #c9302c !important;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.3);
        }

        /* Estilos para la barra de contenido */
        .content {
            margin-top: 100px;
            padding: 20px;
        }

        /* Ajustar la posición del botón */
        .d-flex.justify-content-end.mb-3 {
            margin-top: 70px;
        }

        /* Estilos para las secciones dinámicas */
        .dynamic-section {
            display: none;
            text-align: center;
            margin-top: 20px;
        }

        .dynamic-section.active {
            display: block;
        }

        /* Ajustes en la tabla para ajustarla hacia adentro y evitar desbordes */
        .table-responsive {
            width: 100%;
            overflow-x: auto;
            margin: 0 10px; /* Reduce los márgenes laterales */
            padding: 0 10px; /* Agrega padding en los lados */
            box-sizing: border-box; /* Asegura que los padding no afecten el tamaño del contenedor */
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        table th, table td {
            padding: 12px 10px; /* Reduce el padding horizontal para ajustarse mejor */
            text-align: center;
            border: 1px solid #ddd;
        }

        table th {
            background-color: #d3d3d3;
            color: #333;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            text-align: center; /* Asegura que el texto está centrado */
        }

        /* Estilos para filas alternadas */
        table tr:nth-child(even) {
            background-color: #f4f4f4;
        }

        table tr:nth-child(odd) {
            background-color: #ffffff;
        }

        /* Fila seleccionada */
        table tr.selected {
            background-color: #e6e6e6;
        }

        /* Estilo para la barra de búsqueda */
        .dataTables_filter input {
            background-color: #e9ecef;
            border: 1px solid #ced4da;
            border-radius: 4px;
            padding: 8px 12px;
            width: 250px;
            font-size: 14px;
            margin-left: 10px;
        }

        .dataTables_filter label {
            font-weight: bold;
            font-size: 14px;
            color: #333;
        }

        /* Estilo para la paginación */
        .dataTables_paginate {
            text-align: center;
            margin-top: 15px;
        }

        .dataTables_paginate .paginate_button {
            background-color: #d3d3d3;
            color: #333;
            border: 1px solid #ced4da;
            padding: 6px 12px;
            margin: 0 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .dataTables_paginate .paginate_button:hover {
            background-color: #c0c0c0;
        }

        .dataTables_paginate .paginate_button.disabled {
            background-color: #e0e0e0;
            color: #999;
            cursor: not-allowed;
        }

        /* Estilo para la longitud de la tabla */
        .dataTables_length select {
            background-color: #e9ecef;
            border: 1px solid #ced4da;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
        }

        /* Estilo para el mensaje de "Mostrando X de X" */
        .dataTables_info {
            font-size: 14px;
            color: #333;
            margin-top: 10px;
        }

        /* Estilo para cuando no hay datos */
        .dataTables_empty {
            text-align: center;
            padding: 15px;
            font-size: 16px;
            color: #999;
        }

        /* Media Queries para responsividad */
        @media (max-width: 768px) {
            .main-menu {
                flex-direction: column;
                padding: 15px;
            }

            .table-responsive {
                margin: 0 10px; /* Ajuste aún más los márgenes en móviles */
            }

            table {
                font-size: 14px;
            }

            .dataTables_filter input {
                width: 100%;
                margin-left: 0;
            }

            .dataTables_length select {
                width: 100%;
            }
        }

        /* Mejora de accesibilidad: enfoque en enlaces y botones */
        .main-menu a:focus, 
        .logout-button:focus {
            outline: 2px solid #0056b3;
        }
        
        /* Solución para estilos de DataTables que pueden sobreescribir */
        .dataTable thead th {
            text-align: center !important; /* Asegura el centrado horizontal */
            vertical-align: middle !important; /* Asegura el centrado vertical */
        }

        /* Estilos para el modal y su contenido */
        .modal-content {
            background-color: #f9f9f9;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .modal-header {
            background-color: #007bff;
            color: white;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
            padding: 15px;
            font-weight: bold;
            font-size: 18px;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-title {
            font-size: 18px;
            font-weight: bold;
        }

        /* Estilos para el formulario */
        .form-label {
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .form-control, .form-select {
            font-size: 14px;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            margin-bottom: 15px;
            width: 100%;
        }

        .form-control-sm, .form-select-sm {
            font-size: 14px;
            padding: 8px;
        }

        /* Estilo para los botones */
        button {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        button[type="submit"] {
            background-color: #007bff;
            color: white;
        }

        button[type="submit"]:hover {
            background-color: #0056b3;
        }

        button[type="button"] {
            background-color: #6c757d;
            color: white;
        }

        button[type="button"]:hover {
            background-color: #5a6268;
        }

        /* Estilos para los separadores */
        hr {
            border: 1px solid #e0e0e0;
            margin-top: 1rem;
            margin-bottom: 1rem;
        }

        /* Estilos para el modal cuando se visualiza en dispositivos pequeños */
        @media (max-width: 768px) {
            .modal-dialog {
                max-width: 100%;
                margin: 20px;
            }
        }

        /* Estilos para las filas y columnas del formulario */
        .row {
            margin-bottom: 15px;
        }

        .col-md-6 {
            padding-left: 10px;
            padding-right: 10px;
        }

        /* Estilo para la fila de botones */
        .d-flex.justify-content-between {
            margin-top: 15px;
        }

        .d-flex.justify-content-between button {
            width: 48%;
        }

        #reset-password-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            max-width: 400px;
            width: 100%;
            padding: 20px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin: auto;
        }

        #responseMessage {
            margin-top: 15px;
        }

        #responseMessage {
            margin-top: 15px;
        }

        #resetbut {
            margin-top: 10px;
        }

        #envi {
            color: #007bff;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        #envi:active {
            color: #0056b3;
            transform: scale(1.1);
        }

        #envi:hover {
            color: #27c1cc;
            text-decoration: underline;
            transform: scale(1.1);
        }

        /* Estilo base para el submenú */
        .submenu {
            position: absolute;
            top: 100%; /* Justo debajo del menú principal */
            left: 0; /* Alineado con el elemento padre */
            width: 200px; /* Ajusta el ancho según tus necesidades */
            background-color: #007bff;
            border-radius: 5px;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.2);
            display: none; /* Oculto por defecto */
            z-index: 1001;
        }

        /* Mostrar submenú cuando el padre está en hover o cuando tiene la clase activa */
        .menu-item:hover .submenu,
        .menu-item.active .submenu {
            display: block;
        }

        /* Estilo de los enlaces del submenú */
        .submenu a {
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            white-space: nowrap; /* Evita el salto de línea */
        }

        .submenu a:hover {
            background-color: #0056b3;
            box-shadow: inset 0 0 10px rgba(0, 86, 179, 0.5);
        }

        /* Iconos en el submenú */
        .submenu a img {
            width: 25px;
            height: 25px;
            margin-right: 10px;
        }

        /* Efecto activo en el submenú */
        .submenu a.active {
            background-color: #0056b3;
            font-weight: bold;
        }

        /* Asegura que el contenedor principal permita la posición absoluta */
        .menu-item {
            position: relative; /* Necesario para que el submenú se posicione respecto al padre */
        }
        
        /* Resaltar menú activo */
        .menu-item.active a {
            background-color: #0056b3;
            color: white;
        }

        /* Resaltar enlaces de menú principal */
        .menu-item a.active {
            background-color: #0056b3;
            color: white;
        }

        /* Estilo para los iconos dentro de los botones */
        .icon-btn {
            margin-right: 2px; /* Espacio más pequeño entre el icono y el texto */
            vertical-align: middle; /* Alinea el icono con el texto */
            width: 10px; /* Hace el icono más pequeño */
            height: 10px; /* Hace el icono más pequeño */
        }

        /* Personaliza el tamaño de los botones */
        .custom-btn {
            padding: 4px 10px;  /* Reducir el padding para hacer el botón más pequeño */
            font-size: 12px; /* Reduce el tamaño de la fuente */
            display: flex;
            align-items: center; /* Alinea el texto y el icono de manera vertical */
        }

        /* Asegura que los botones estén alineados horizontalmente */
        .d-flex {
            display: flex;
            justify-content: center; /* Alinea los botones al centro */
            gap: 8px; /* Espacio entre los botones */
            justify-content: center; /* Alinea los botones hacia la izquierda */
        }

        /* Asegura que Select2 se muestre correctamente en el modal */
        .select2-container {
            z-index: 2050 !important; /* Un valor más alto que el modal de Bootstrap */
        }

        .select2-container--open {
            z-index: 2051 !important;
        }

        /* Cambiar el fondo y bordes del contenedor principal */
        .select2-container--default .select2-selection--single {
        background-color: #f9f9f9;
        border: 1px solid #ccc;
        border-radius: 4px;
        height: 40px; /* Ajustar altura */
        display: flex;
        align-items: center;
        }

        /* Cambiar el estilo al hacer hover */
        .select2-container--default .select2-selection--single:hover {
        border-color: #888;
        }

        /* Personalizar el texto */
        .select2-container--default .select2-selection--single .select2-selection__rendered {
        color: #333;
        font-size: 14px;
        padding-left: 10px;
        }

        /* Personalizar el ícono del dropdown */
        .select2-container--default .select2-selection--single .select2-selection__arrow b {
        border-color: #333 transparent transparent transparent;
        border-width: 6px 6px 0 6px;
        }

        /* Cambiar el fondo del dropdown */
        .select2-container--default .select2-results__options {
        background-color: #fff;
        border: 1px solid #ccc;
        }

        /* Estilo para opciones seleccionadas */
        .select2-container--default .select2-results__option--highlighted[aria-selected] {
        background-color: #007bff;
        color: white;
        }

        /* Asegurar que SweetAlert2 esté por encima */
        .swal2-container {
            z-index: 9999 !important;
        }

        /* Quitar color amarillento del autocompletar en navegadores */
        input:-webkit-autofill {
            background-color: #fff !important; /* Fondo blanco */
            color: #000 !important; /* Texto negro */
            -webkit-box-shadow: 0 0 0px 1000px white inset; /* Forzar fondo blanco */
            transition: background-color 5000s ease-in-out 0s; /* Asegurar persistencia */
        }

        /* Animación de presión */
        .btn:active {
            transform: scale(0.95); /* Reduce ligeramente el tamaño */
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2); /* Simula un clic más dinámico */
        }

        /* Efecto de onda */
        .btn:focus-visible::after, 
        .btn:active::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 200%;
            height: 200%;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            z-index: 1;
            pointer-events: none;
            animation: ripple 0.5s linear;
        }

        /* Animación del efecto de onda */
        @keyframes ripple {
            from {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0.8;
            }
            to {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0;
            }
        }

    </style>
    
</head>
<body>

<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <script>
        // Esto es para asegurarse de que solo un enlace tenga la clase "active" a la vez.
        $(document).ready(function() {
            // Selecciona todos los enlaces en el menú principal
            $('.main-menu a').on('click', function() {
                // Primero, quita la clase "active" de todos los enlaces
                $('.main-menu a').removeClass('active');
                
                // Luego, añade la clase "active" solo al enlace que fue clicado
                $(this).addClass('active');
            });
        });
        
        // Detectar el scroll y aplicar los cambios en el menú
        window.addEventListener('scroll', function() {
            const menu = document.querySelector('.main-menu');
            if (window.scrollY > 100) {  // Ajusta este valor según el umbral de scroll deseado
                menu.classList.add('vertical');
            } else {
                menu.classList.remove('vertical');
            }
        });

        // Función para mostrar las secciones
            function showSection(sectionId) {
            // Ocultar todas las secciones
            const sections = document.querySelectorAll('.dynamic-section');
            sections.forEach(section => section.classList.remove('active'));

            // Mostrar la sección seleccionada
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.add('active');
            }
        }

    </script>

<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <div class="container mt-5"></div>
        <!-- Sección de inicio de sesión -->
        <div id="login-section">
            <img id="logo" src="https://i.ibb.co/kGtxTqp/logol.png" alt="Logo de la organización">
            <p id="organization-name">FACULTAD DE CIENCIAS ECONÓMICAS Y SOCIALES (FCES DECANATO)</p>
            <h2>Iniciar Sesión</h2>
            <input type="text" id="codigo_adm" placeholder="Código Administrativo">
            <input type="password" id="password" placeholder="Contraseña">
            <button id="login-button" class="btn btn-primary" onclick="handleLogin()">
                <i class="bi bi-box-arrow-in-right me-2"></i> Iniciar Sesión
            </button>            
            <a id="envi" href="#" class="d-block text-center mt-3" onclick="showResetPasswordForm()">Recuperar Contraseña</a>
        </div>
        <!-- Sección de recuperación de contraseña -->
        <div id="reset-password-section" style="display: none;">
            <h2 class="text-center">Restablecer Contraseña</h2>
            <form id="resetPasswordForm">
                <div class="mb-3">
                    <label for="correo" class="form-label">Correo Electrónico:</label>
                    <input type="email" class="form-control" id="correo" name="correo" required>
                </div>
                <div class="mb-3">
                    <label for="identificador" class="form-label">Identificador (Código Administrativo):</label>
                    <input type="text" class="form-control" id="identificador" name="identificador" required>
                </div>
                <button type="submit" class="btn btn-primary w-100" id="resetbut">
                    <i class="bi bi-send"></i> Enviar
                </button>                
            </form>
            <button class="btn btn-secondary w-100 mt-3" onclick="showLoginForm()">
                <i class="bi bi-arrow-left me-2"></i> Regresar
            </button>            
            <div id="responseMessage" class="mt-3"></div>
        </div>
    </div>

<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <script>
        // Mostrar formulario de recuperación de contraseña
        function showResetPasswordForm() {
            document.getElementById('login-section').style.display = 'none';
            document.getElementById('reset-password-section').style.display = 'block';
            document.getElementById('resetPasswordForm').reset(); // Limpiar el formulario
            document.getElementById('responseMessage').innerHTML = ''; // Limpiar mensajes de respuesta
        }

        // Mostrar formulario de inicio de sesión
        function showLoginForm() {
            document.getElementById('reset-password-section').style.display = 'none';
            document.getElementById('login-section').style.display = 'block';
            document.getElementById('resetPasswordForm').reset(); // Limpiar el formulario
            document.getElementById('responseMessage').innerHTML = ''; // Limpiar mensajes de respuesta
        }

        document.getElementById('resetPasswordForm').addEventListener('submit', async function(event) {
            event.preventDefault(); // Prevenir el envío tradicional del formulario
            console.log("Formulario enviado");

            // Recoger los valores de los campos
            const correo = document.getElementById('correo').value;
            const identificador = document.getElementById('identificador').value;

            // Validación del correo
            const emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;
            if (!emailPattern.test(correo)) {
                document.getElementById('responseMessage').innerHTML = `<div class="alert alert-danger">El correo electrónico no es válido.</div>`;
                return;
            }

            // Deshabilitar el botón para evitar envíos múltiples
            const submitBtn = document.getElementById('resetbut');
            submitBtn.disabled = true;
            submitBtn.innerText = 'Enviando...';
            
            // Definir el endpoint para la API
            const url = 'https://finalapi.up.railway.app/apis/reset-password/';  // Cambiar a la URL de la API correcta
            const payload = { correo, identificador };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload),
                });

                const contentType = response.headers.get("Content-Type");
                let result = {};
                if (contentType && contentType.includes("application/json")) {
                    result = await response.json();
                } else {
                    throw new Error("La respuesta no es un formato JSON.");
                }

                // Mostrar la respuesta según el resultado
                const responseMessage = document.getElementById('responseMessage');
                if (response.ok) {
                    responseMessage.innerHTML = `<div class="alert alert-success">${result.mensaje}</div>`;
                } else {
                    responseMessage.innerHTML = `<div class="alert alert-danger">Error: ${result.detail || 'No se pudo procesar la solicitud.'}</div>`;
                }
            } catch (error) {
                document.getElementById('responseMessage').innerHTML = `<div class="alert alert-danger">Error: ${error.message}</div>`;
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerText = 'Enviar';
            }
        });


    </script>
    
<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <!-- Menú principal -->
    <div class="main-menu" id="main-menu" style="display: none;">
        <a href="javascript:void(0)" onclick="showSection('student-section')">
            <img src="https://i.ibb.co/qBy6cMn/graduado.png" alt="Estudiantes" class="menu-icon">
            <span class="menu-text">Estudiantes</span>
        </a>
        <a href="javascript:void(0)" onclick="showSection('teacher-section')">
            <img src="https://i.ibb.co/L9dnYVT/profesor.png" alt="Docentes" class="menu-icon">
            <span class="menu-text">Docentes</span>
        </a>
        <a href="javascript:void(0)" onclick="showSection('admin-section')">
            <img src="https://i.ibb.co/ydyyhZP/gerente.png" alt="Administradores" class="menu-icon">
            <span class="menu-text">Administradores</span>
        </a>
        <a href="javascript:void(0)" onclick="showSection('course-section')">
            <img src="https://i.ibb.co/DKJsFVw/curso.png" alt="Cursos" class="menu-icon">
            <span class="menu-text">Cursos</span>
        </a>
        <a href="javascript:void(0)" onclick="showSection('registration-section')">
            <img src="https://i.ibb.co/CsVBMyk/inscripcion.png" alt="Inscripciones" class="menu-icon">
            <span class="menu-text">Inscripciones</span>
        </a>
        <a href="javascript:void(0)" onclick="showSection('payment-section')">
            <img src="https://i.ibb.co/r3sKS1M/metodo-de-pago.png" alt="Pagos" class="menu-icon">
            <span class="menu-text">Pagos</span>
        </a>
        <a href="javascript:void(0)" onclick="showSection('report-section')">
            <img src="https://i.ibb.co/Mnvddfs/informe-seo.png" alt="Informe" class="menu-icon">
            <span class="menu-text">Informe</span>
        </a>

        <!-- Nueva sección: Usuario -->
        <div class="menu-item user-menu">
            <a href="javascript:void(0)" onclick="toggleUserMenu()">
                <img src="https://i.ibb.co/74JFWxt/menu.png" alt="Usuario" class="menu-icon">
                <span class="menu-text" id="menu-user-text">Usuario</span>
            </a>            
            <div class="submenu" id="user-submenu">
                <a id="change-password-link" href="javascript:void(0)" onclick="showChangePasswordSection()">
                    <img src="https://i.ibb.co/wYhWc5r/contrasena.png" alt="Cambiar Contraseña" class="submenu-icon">
                    Contraseña
                </a>
                <a href="javascript:void(0)" onclick="handleLogout()">
                    <img src="https://i.ibb.co/WWg972j/cerrar-sesion.png" alt="Cerrar Sesión" class="submenu-icon">
                    Cerrar Sesión
                </a>
            </div>
        </div>
    </div>

    <!-- Secciones dinámicas -->

<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <script>
        // Variable global para almacenar el menú abierto actualmente
        let currentOpenMenu = null;

        // Función para alternar el menú de Usuario
        function toggleUserMenu(event) {
            const submenu = document.getElementById('user-submenu');
            const menuItem = document.querySelector('.user-menu');

            // Si ya hay un menú abierto, lo cerramos
            if (currentOpenMenu && currentOpenMenu !== menuItem) {
                currentOpenMenu.querySelector('.submenu').style.display = 'none';
                currentOpenMenu.classList.remove('active');
            }

            // Alternar el submenú del menú actual
            if (submenu.style.display === 'block') {
                submenu.style.display = 'none';
                menuItem.classList.remove('active');
                currentOpenMenu = null; // Ningún menú está abierto
            } else {
                submenu.style.display = 'block';
                menuItem.classList.add('active');
                currentOpenMenu = menuItem; // Establecer el menú actual como abierto
            }
        }

        // Función para resaltar la opción del menú seleccionada
        function showSection(sectionId) {
            // Desmarcar todas las secciones
            const sections = document.querySelectorAll('.menu-item');
            sections.forEach(item => {
                item.classList.remove('active');
            });

            // Marcar la sección activa
            const selectedSection = document.querySelector(`[onclick="showSection('${sectionId}')"]`);
            if (selectedSection) {
                selectedSection.parentElement.classList.add('active');  // Asegúrate de resaltar el contenedor
            }

            // Mostrar u ocultar la sección correspondiente
            const sectionsToHide = document.querySelectorAll('.section');
            sectionsToHide.forEach(section => {
                section.style.display = 'none';
            });

            const sectionToShow = document.getElementById(sectionId);
            if (sectionToShow) {
                sectionToShow.style.display = 'block';
            }
        }

        // Cerrar el submenú si se hace clic fuera del menú
        document.addEventListener('click', function(event) {
            const menuItem = document.querySelector('.user-menu');
            const submenu = document.getElementById('user-submenu');

            // Si se hace clic fuera del menú, cerrar el submenú
            if (!menuItem.contains(event.target)) {
                submenu.style.display = 'none';
                menuItem.classList.remove('active');
                currentOpenMenu = null;
            }
        });


    </script>

<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <!-- Sección de Actualizar Contraseña -->
    <div class="container mt-5" id="change-password-section" style="display: none;">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <h2 class="text-center mb-4">Actualizar Contraseña</h2>
                <form onsubmit="updatePassword(event)" class="p-4 border rounded shadow-sm bg-light">
                    <div class="mb-3">
                        <label for="username" class="form-label">Perfil</label>
                        <input type="text" id="username" name="username" class="form-control" required disabled>
                    </div>                                      
                    <div class="mb-3">
                        <label for="password" class="form-label">Contraseña Actual</label>
                        <input type="password" id="password4" name="password" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label for="new_password" class="form-label">Nueva Contraseña</label>
                        <input type="password" id="new_password" name="new_password" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="bi bi-key me-2"></i>
                        <span class="spinner d-none"></span>
                        Actualizar Contraseña
                    </button>                                        
                </form>
                <div id="message" class="mt-3"></div>
            </div>
        </div>
    </div>


<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <script>
        
        // Función para mostrar la sección de Actualizar Contraseña
        function showChangePasswordSection() {
            // Ocultar otras secciones
            const sections = document.querySelectorAll('.dynamic-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });

            // Mostrar la sección de Actualizar Contraseña
            const changePasswordSection = document.getElementById('change-password-section');
            if (changePasswordSection) {
                changePasswordSection.style.display = 'block';
            }

            // Resaltar el enlace del menú activo (si es necesario)
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => {
                item.classList.remove('active');
            });

            const passwordLink = document.getElementById('change-password-link');
            if (passwordLink) {
                passwordLink.parentElement.classList.add('active');  // Resalta el enlace activo en el menú
            }
        }

        async function updatePassword(event) {
            event.preventDefault();

            // Get form values
            const username = document.getElementById('username').value;
            const password = document.getElementById('password4').value;
            const newPassword = document.getElementById('new_password').value;

            const messageDiv = document.getElementById('message');
            
            // Show "Enviando..." message before the request starts
            messageDiv.textContent = "Enviando...";
            messageDiv.className = 'alert alert-info';  // Optional: To indicate sending state

            // Send request to the server
            const response = await fetch('https://finalapi.up.railway.app/update-password/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    username: username,
                    password: password,
                    new_password: newPassword,
                }),
            });

            const result = await response.json();

            // Update the message div based on the response
            if (response.ok) {
                messageDiv.textContent = result.message;
                messageDiv.className = 'alert alert-success';
            } else {
                messageDiv.textContent = result[Object.keys(result)[0]] || 'Error desconocido';
                messageDiv.className = 'alert alert-danger';
            }

            // Clear form fields after sending the request
            document.getElementById('password4').value = '';
            document.getElementById('new_password').value = '';

            // Reset message state after 5 seconds
            setTimeout(() => {
                messageDiv.textContent = '';
                messageDiv.className = '';
            }, 5000);

            // Optionally reset form field validation highlights if any
            document.querySelectorAll('.form-control').forEach(input => {
                input.classList.remove('is-invalid', 'is-valid');
            });

            // If you need to reset the form with form.reset():
            // document.getElementById('password-form').reset();  // Un-comment this if you're using a form element.
        }

        function showSection(sectionId) {
            document.querySelectorAll('.container').forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById(sectionId).style.display = 'block';
        }

    </script>

<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->


    <div id="student-section" class="dynamic-section">
        <!-- Contenido de estudiantes -->
        
        <div class="card mt-4">
            <div class="d-flex justify-content-end mb-7">
                <div class="d-flex justify-content-end mb-3">
                    <button id="btnAgregarEstudiantes" class="btn btn-primary mb-4 d-flex align-items-center gap-1" onclick="abrirAgregarE()">
                        <img src="https://i.ibb.co/qBy6cMn/graduado.png" alt="Agregar" width="20" height="20">
                        <span>Agregar</span>
                    </button>
                </div>
            </div>
            <div class="card-header d-flex justify-content-between align-items-center">
                <span class="text-center flex-grow-1">Listado de Estudiantes</span>
                <button 
                    class="btn btn-light btn-sm p-0 shadow-sm" 
                    onclick="cargarEstudiantes()" 
                    title="Actualizar" 
                    style="width: 25px; height: 25px; border-radius: 50%;">
                    <i class="bi bi-arrow-clockwise"></i>
                </button>
            </div>            
            <div class="card-body">
                <div class="table-responsive">
                    <table id="estudiantes-table" class="table table-striped table-bordered">
                        <thead class="table table-striped">
                            <tr>
                                <th>Matrícula</th>
                                <th>Nombre Completo</th>
                                <th>Cédula</th>
                                <th>Correo</th>
                                <th>Teléfono</th>
                                <th>Celular</th>
                                <th>Dirección</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="estudiantes-table-body">
                            <!-- Filas se generarán dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Modal para Agregar Estudiante -->
        <div class="modal fade" id="modalAgregarE" tabindex="-1" aria-labelledby="modalAgregarLabelE" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="modalAgregarLabelE">Agregar Estudiante</h5>
                        <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close">
                            <i class="bi bi-x-lg"></i>
                        </button>                        
                    </div>
                    <div class="modal-body">
                        <form id="add-form" onsubmit="guardarAgregarE(event)">
                            <!-- Datos Personales -->
                            <div class="row mb-2">
                                <div class="col-md-6">
                                    <label for="add-nombre" class="form-label small">Nombre Completo</label>
                                    <input type="text" id="add-nombre" class="form-control form-control-sm" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="add-cedula" class="form-label small">Cédula</label>
                                    <input type="text" id="add-cedula" class="form-control form-control-sm" required>
                                </div>
                            </div>
                            <div class="row mb-2">
                                <div class="col-md-12">
                                    <label for="add-correo" class="form-label small">Correo</label>
                                    <input type="email" id="add-correo" class="form-control form-control-sm w-100" required>
                                </div>
                            </div>

                            <hr class="my-2"> <!-- Separador entre Datos Personales y Datos de Contacto -->

                            <!-- Datos de Contacto -->
                            <div class="row mb-2">
                                <div class="col-md-6">
                                    <label for="add-telefono" class="form-label small">Teléfono</label>
                                    <input type="text" id="add-telefono" class="form-control form-control-sm">
                                </div>
                                <div class="col-md-6">
                                    <label for="add-celular" class="form-label small">Celular</label>
                                    <input type="text" id="add-celular" class="form-control form-control-sm">
                                </div>
                            </div>
                            <div class="row mb-2">
                                <div class="col-md-12">
                                    <label for="add-direccion" class="form-label small">Dirección</label>
                                    <input type="text" id="add-direccion" class="form-control form-control-sm w-100">
                                </div>
                            </div>

                            <hr class="my-2"> <!-- Separador entre Seguridad y Estado -->

                            <!-- Estado y Matrícula -->
                            <div class="row mb-2">
                                <div class="col-md-6">
                                    <label for="add-estado" class="form-label small">Estado</label>
                                    <select id="add-estado" class="form-select form-select-sm" required>
                                        <option value="activo">Activo</option>
                                        <option value="inactivo">Inactivo</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="add-matricula" class="form-label small">Matrícula</label>
                                    <input type="text" id="add-matricula" class="form-control form-control-sm">
                                </div>
                            </div>

                            <div class="d-flex justify-content-end mt-2">
                                <button type="submit" class="btn btn-primary btn-sm me-2">
                                    <i class="bi bi-save me-1"></i> Guardar
                                </button>  

                                <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">
                                    <i class="bi bi-x-circle me-1"></i> Cancelar
                                </button>                                
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal para Editar Estudiante -->
        <div class="modal fade" id="modalEditarE" tabindex="-1" aria-labelledby="modalEditarLabelE" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="modalEditarLabelE">Editar Estudiante</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="edit-form" onsubmit="guardarEditarE(event)">
                            <input type="hidden" id="edit-id">

                            <!-- Datos Personales -->
                            <div class="row mb-2">
                                <div class="col-md-6">
                                    <label for="edit-nombre" class="form-label small">Nombre Completo</label>
                                    <input type="text" id="edit-nombre" class="form-control form-control-sm" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="edit-cedula" class="form-label small">Cédula</label>
                                    <input type="text" id="edit-cedula" class="form-control form-control-sm" required>
                                </div>
                            </div>
                            <div class="row mb-2">
                                <div class="col-md-12">
                                    <label for="edit-correo" class="form-label small">Correo</label>
                                    <input type="email" id="edit-correo" class="form-control form-control-sm" required>
                                </div>
                            </div>

                            <hr class="my-2">

                            <!-- Datos de Contacto -->
                            <div class="row mb-2">
                                <div class="col-md-6">
                                    <label for="edit-telefono" class="form-label small">Teléfono</label>
                                    <input type="text" id="edit-telefono" class="form-control form-control-sm">
                                </div>
                                <div class="col-md-6">
                                    <label for="edit-celular" class="form-label small">Celular</label>
                                    <input type="text" id="edit-celular" class="form-control form-control-sm">
                                </div>
                            </div>
                            <div class="row mb-2">
                                <div class="col-md-12">
                                    <label for="edit-direccion" class="form-label small">Dirección</label>
                                    <input type="text" id="edit-direccion" class="form-control form-control-sm">
                                </div>
                            </div>

                            <hr class="my-2">

                            <!-- Estado y Matrícula -->
                            <div class="row mb-2">
                                <div class="col-md-6">
                                    <label for="edit-estado" class="form-label small">Estado</label>
                                    <select id="edit-estado" class="form-select form-select-sm" required>
                                        <option value="activo">Activo</option>
                                        <option value="inactivo">Inactivo</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="edit-matricula" class="form-label small">Matrícula</label>
                                    <input type="text" id="edit-matricula" class="form-control form-control-sm">
                                </div>
                            </div>

                            <div class="d-flex justify-content-end mt-2">
                                <button type="submit" class="btn btn-primary btn-sm me-2">
                                    <i class="bi bi-save me-1"></i> Guardar Cambios
                                </button>                                
                                <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">
                                    <i class="bi bi-x-circle me-1"></i> Cancelar
                                </button>                                
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <div id="teacher-section" class="dynamic-section">
        <!-- Contenido de docentes -->

        <div class="card mt-4">
            <div class="d-flex justify-content-end mb-3">
                <button id="btnAgregarDocentes" class="btn btn-primary d-flex align-items-center gap-1" onclick="abrirAgr()">
                    <img src="https://i.ibb.co/L9dnYVT/profesor.png" alt="Agregar" width="20" height="20">
                    <span>Agregar</span>
                </button>
            </div>
            <div class="card-header d-flex justify-content-between align-items-center">
                <span class="text-center flex-grow-1">Listado de Docentes</span>
                <button 
                    class="btn btn-light btn-sm p-0 shadow-sm" 
                    onclick="cargarDocent()" 
                    title="Actualizar" 
                    style="width: 25px; height: 25px; border-radius: 50%;">
                    <i class="bi bi-arrow-clockwise"></i>
                </button>
            </div>            
            <div class="card-body">
                <div class="table-responsive">
                    <table id="docentes-table" class="table table-striped table-bordered">
                        <thead class="table table-striped">
                            <tr>
                                <th>Nombre Completo</th>
                                <th>Cédula</th>
                                <th>Correo</th>
                                <th>Teléfono</th>
                                <th>Activo/Jubilado</th>
                                <th>Código</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="docentes-table-body">
                            <!-- Filas dinámicas -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>   
        
        <!-- Modal para Agregar/Editar Docente -->
        <div class="modal fade" id="modalDocente" tabindex="-1" aria-labelledby="modalDocenteLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="modalDocenteLabel">Agregar Docente</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="docente-form" onsubmit="guardarDocente(event)">
                            <input type="hidden" id="docente-id">

                            <!-- Información Personal -->
                            <h6 class="border-bottom pb-2 mb-3">Información Personal</h6>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label for="nombre_completod" class="form-label">Nombre Completo</label>
                                    <input type="text" id="nombre_completod" class="form-control" required>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="cedulad" class="form-label">Cédula</label>
                                    <input type="text" id="cedulad" class="form-control" required>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="correod" class="form-label">Correo Electrónico</label>
                                    <input type="email" id="correod" class="form-control" required>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label for="telefonod" class="form-label">Teléfono</label>
                                    <input type="text" id="telefonod" class="form-control">
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="celulard" class="form-label">Celular</label>
                                    <input type="text" id="celulard" class="form-control">
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="direcciond" class="form-label">Dirección</label>
                                    <input type="text" id="direcciond" class="form-control">
                                </div>
                            </div>

                            <!-- Detalles Profesionales -->
                            <h6 class="border-bottom pb-2 mb-3">Detalles Profesionales</h6>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label for="especialidadd" class="form-label">Especialidad</label>
                                    <input type="text" id="especialidadd" class="form-control">
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="fecha_contratacion" class="form-label">Fecha de Contratación</label>
                                    <input type="date" id="fecha_contratacion" class="form-control">
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="facultadd" class="form-label">Facultad</label>
                                    <select id="facultadd" class="form-control select2" style="width: 100%;" required>
                                        <option value="">Seleccione una facultad</option>
                                        <option value="humanidades">Humanidades</option>
                                        <option value="ciencias">Ciencias</option>
                                        <option value="ciencias_economicas_sociales">Ciencias Económicas y Sociales</option>
                                        <option value="ciencias_juridicas_politicas">Ciencias Jurídicas y Políticas</option>
                                        <option value="ingenieria_arquitectura">Ingeniería y Arquitectura</option>
                                        <option value="ciencias_salud">Ciencias de la Salud</option>
                                        <option value="ciencias_agronomicas_veterinarias">Ciencias Agronómicas y Veterinarias</option>
                                        <option value="artes">Artes</option>
                                        <option value="ciencias_educacion">Ciencias de la Educación</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label for="escuelad" class="form-label">Escuela</label>
                                    <select id="escuelad" class="form-control" required>
                                        <option value="">Seleccione una escuela</option>
                                        <!-- Humanidades -->
                                        <optgroup label="Humanidades">
                                            <option value="comunicacion_social">Comunicación Social</option>
                                            <option value="filosofia">Filosofía</option>
                                            <option value="idiomas">Idiomas</option>
                                            <option value="letras">Letras</option>
                                            <option value="psicologia">Psicología</option>
                                            <option value="historia_antropologia">Historia y Antropología</option>
                                        </optgroup>
                                        <!-- Ciencias -->
                                        <optgroup label="Ciencias">
                                            <option value="biologia">Biología</option>
                                            <option value="fisica">Física</option>
                                            <option value="geografia">Geografía</option>
                                            <option value="informatica">Informática</option>
                                            <option value="matematicas">Matemáticas</option>
                                            <option value="microbiologia_parasitologia">Microbiología y Parasitología</option>
                                            <option value="quimica">Química</option>
                                        </optgroup>
                                        <!-- Ciencias Económicas y Sociales -->
                                        <optgroup label="Ciencias Económicas y Sociales">
                                            <option value="administracion">Administración</option>
                                            <option value="economia">Economía</option>
                                            <option value="mercadotecnia">Mercadotecnia</option>
                                            <option value="estadistica">Estadística</option>
                                            <option value="sociologia">Sociología</option>
                                            <option value="contabilidad">Contabilidad</option>
                                            <option value="turismo_hoteleria">Turismo y Hotelería</option>
                                        </optgroup>
                                        <!-- Ciencias Jurídicas y Políticas -->
                                        <optgroup label="Ciencias Jurídicas y Políticas">
                                            <option value="derecho">Derecho</option>
                                            <option value="ciencias_politicas">Ciencias Políticas</option>
                                        </optgroup>
                                        <!-- Ingeniería y Arquitectura -->
                                        <optgroup label="Ingeniería y Arquitectura">
                                            <option value="arquitectura">Arquitectura</option>
                                            <option value="ingenieria_electromecanica">Ingeniería Electromecánica</option>
                                            <option value="ingenieria_civil">Ingeniería Civil</option>
                                            <option value="ingenieria_quimica">Ingeniería Química</option>
                                            <option value="agrimensura">Agrimensura</option>
                                            <option value="ingenieria_industrial">Ingeniería Industrial</option>
                                        </optgroup>
                                        <!-- Ciencias de la Salud -->
                                        <optgroup label="Ciencias de la Salud">
                                            <option value="bioanalisis">Bioanálisis</option>
                                            <option value="ciencias_morfologicas">Ciencias Morfológicas</option>
                                            <option value="farmacia">Farmacia</option>
                                            <option value="ciencias_fisiologicas">Ciencias Fisiológicas</option>
                                            <option value="enfermeria">Enfermería</option>
                                            <option value="odontologia">Odontología</option>
                                            <option value="medicina">Medicina</option>
                                            <option value="salud_publica">Salud Pública</option>
                                        </optgroup>
                                        <!-- Ciencias Agronómicas y Veterinarias -->
                                        <optgroup label="Ciencias Agronómicas y Veterinarias">
                                            <option value="agronomia">Agronomía</option>
                                            <option value="zootecnia">Zootecnia</option>
                                            <option value="veterinaria">Veterinaria</option>
                                        </optgroup>
                                        <!-- Artes -->
                                        <optgroup label="Artes">
                                            <option value="critica_historia_arte">Crítica e Historia del Arte</option>
                                            <option value="publicidad">Publicidad</option>
                                            <option value="teatro_danza">Teatro y Danza</option>
                                            <option value="musica">Música</option>
                                            <option value="cine_tv_fotografia">Cine, Televisión y Fotografía</option>
                                            <option value="diseno_industrial_moda">Diseño Industrial y de Moda</option>
                                            <option value="artes_plasticas">Artes Plásticas</option>
                                        </optgroup>
                                        <!-- Ciencias de la Educación -->
                                        <optgroup label="Ciencias de la Educación">
                                            <option value="teoria_gestion_educativa">Teoría y Gestión Educativa</option>
                                            <option value="educacion_infantil_basica">Educación Infantil y Básica</option>
                                            <option value="educacion_media">Educación Media</option>
                                            <option value="orientacion_pedagogia">Orientación y Pedagogía</option>
                                            <option value="educacion_fisica_deporte">Educación Física y Ciencias del Deporte</option>
                                            <option value="bibliotecologia_tecnologia_innovacion">Bibliotecología, Tecnología e Innovación</option>
                                        </optgroup>
                                    </select>
                                </div>                                
                                <div class="col-md-4 mb-3">
                                    <label for="campusd" class="form-label">Campus</label>
                                    <select id="campusd" class="form-control" required>
                                        <option value="">Seleccione un campus</option>
                                        <!-- Sede Central -->
                                        <optgroup label="Sede Central">
                                            <option value="santo_domingo">Santo Domingo</option>
                                        </optgroup>
                                        <!-- Recintos -->
                                        <optgroup label="Recintos">
                                            <option value="san_francisco_macoris">San Francisco de Macorís</option>
                                            <option value="santiago">Santiago</option>
                                            <option value="barahona">Barahona</option>
                                            <option value="san_juan">San Juan</option>
                                        </optgroup>
                                        <!-- Centros -->
                                        <optgroup label="Centros">
                                            <option value="bani">Baní</option>
                                            <option value="higuey">Higüey</option>
                                            <option value="hato_mayor">Hato Mayor</option>
                                            <option value="la_vega">La Vega</option>
                                            <option value="la_romana">La Romana</option>
                                            <option value="bonao">Bonao</option>
                                            <option value="mao">Mao</option>
                                            <option value="nagua">Nagua</option>
                                            <option value="puerto_plata">Puerto Plata</option>
                                            <option value="san_cristobal">San Cristóbal</option>
                                            <option value="santo_domingo_este">Santo Domingo Este</option>
                                            <option value="san_pedro_macoris">San Pedro de Macorís</option>
                                        </optgroup>
                                        <!-- Sub-Centros -->
                                        <optgroup label="Sub-Centros">
                                            <option value="santiago_rodriguez">Santiago Rodríguez</option>
                                            <option value="neyba">Neyba</option>
                                        </optgroup>
                                    </select>
                                </div>
                                
                                <div class="col-md-4 mb-3">
                                    <label for="codigo_doc" class="form-label">Código Docente</label>
                                    <input type="text" id="codigo_doc" class="form-control">
                                </div>
                            </div>

                            <!-- Información Adicional -->
                            <h6 class="border-bottom pb-2 mb-3">Información Adicional</h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="estatusd" class="form-label">Estatus</label>
                                    <select id="estatusd" class="form-select">
                                        <option value="activo">Activo</option>
                                        <option value="jubilado">Jubilado</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="codigod" class="form-label">Código</label>
                                    <select id="codigod" class="form-select">
                                        <option value="invitado">Invitado</option>
                                        <option value="oficial">Oficial</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Botones -->
                            <div class="d-flex justify-content-between">
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-save me-1"></i> Guardar
                                </button>                                
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                    <i class="bi bi-x-circle me-1"></i> Cancelar
                                </button>                                
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <div id="admin-section" class="dynamic-section">
        <!-- Contenido de administradores -->

        <!-- Tabla de administrativos -->
        <div class="card mt-4">
            <div class="d-flex justify-content-end mb-3">
                <button id="btnAgregarAdministradores" class="btn btn-primary d-flex align-items-center gap-1" onclick="abrirAgregarad()">
                    <img src="https://i.ibb.co/ydyyhZP/gerente.png" alt="Agregar" width="20" height="20">
                    <span>Agregar</span>
                </button>
            </div>
            <div class="card-header d-flex justify-content-between align-items-center">
                <span class="text-center flex-grow-1">Listado de Administradores</span>
                <button 
                    class="btn btn-light btn-sm p-0 shadow-sm" 
                    onclick="cargarAdministrativos()" 
                    title="Actualizar" 
                    style="width: 25px; height: 25px; border-radius: 50%;">
                    <i class="bi bi-arrow-clockwise"></i>
                </button>
            </div>            
            <div class="card-body">
                <div class="table-responsive">
                    <table id="adminTable" class="table table-bordered table-striped">
                        <thead class="table table-striped">
                            <tr>
                                <th>Nombre</th>
                                <th>Cédula</th>
                                <th>Correo</th>
                                <th>Teléfono</th>
                                <th>Celular</th>
                                <th>Dirección</th>
                                <th>Departamento</th>
                                <th>Cargo</th>
                                <th>Código Adm</th>
                                <th>Estado</th>
                                <th>Fecha Ingreso</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="table-body">
                            <!-- Aquí se cargarán los datos dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>        
    </div>

    <!-- Modal Agregar Administrativo -->
    <div class="modal fade" id="modalAgregarad" tabindex="-1" aria-labelledby="modalAgregarLabelad" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalAgregarLabelad">Agregar Administrativo</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formAgregarad">
                        
                        <!-- Información Personal -->
                        <h6 class="text-center border-bottom pb-2 mb-3">Información Personal</h6>
                        <div class="row g-2">
                            <div class="col-4">
                                <label for="add-nombread" class="form-label">Nombre</label>
                                <input type="text" id="add-nombread" class="form-control">
                            </div>
                            <div class="col-4">
                                <label for="add-cedulaad" class="form-label">Cédula</label>
                                <input type="text" id="add-cedulaad" class="form-control">
                            </div>
                            <div class="col-4">
                                <label for="add-correoad" class="form-label">Correo</label>
                                <input type="email" id="add-correoad" class="form-control">
                            </div>
                        </div>
                        <div class="row g-2 mt-2">
                            <div class="col-4">
                                <label for="add-telefonoad" class="form-label">Teléfono</label>
                                <input type="text" id="add-telefonoad" class="form-control">
                            </div>
                            <div class="col-4">
                                <label for="add-celularad" class="form-label">Celular</label>
                                <input type="text" id="add-celularad" class="form-control">
                            </div>
                            <div class="col-4">
                                <label for="add-direccionad" class="form-label">Dirección</label>
                                <input type="text" id="add-direccionad" class="form-control">
                            </div>
                        </div>

                        <!-- Credenciales -->
                        <h6 class="text-center border-bottom pb-2 mb-3 mt-3">Credenciales</h6>
                        <div class="row g-2">
                            
                        </div>

                        <!-- Detalles Profesionales -->
                        <h6 class="text-center border-bottom pb-2 mb-3 mt-3">Detalles Profesionales</h6>
                        <div class="row g-2">
                            <div class="col-4">
                                <label for="add-departamentoad" class="form-label">Departamento</label>
                                <input type="text" id="add-departamentoad" class="form-control">
                            </div>
                            <div class="col-4">
                                <label for="add-cargoad" class="form-label">Cargo</label>
                                <input type="text" id="add-cargoad" class="form-control">
                            </div>
                            <div class="col-4">
                                <label for="add-fecha-ingresoad" class="form-label">Fecha Ingreso</label>
                                <input type="date" id="add-fecha-ingresoad" class="form-control">
                            </div>
                        </div>
                        <div class="row g-2 mt-2">
                            <div class="col-4">
                                <label for="add-codigo-admad" class="form-label">Código Adm</label>
                                <input type="text" id="add-codigo-admad" class="form-control">
                            </div>
                        </div>

                        <!-- Información Adicional -->
                        <h6 class="text-center border-bottom pb-2 mb-3 mt-3">Información Adicional</h6>
                        <div class="row g-2">
                            <div class="col-4">
                                <label for="add-estadoad" class="form-label">Estado</label>
                                <select id="add-estadoad" class="form-select" required>
                                    <option value="activo">Activo</option>
                                    <option value="inactivo">Inactivo</option>
                                </select>
                            </div>
                            <div class="col-4">
                                <label for="add-accesoad" class="form-label">Acceso</label>
                                <select id="add-accesoad" class="form-select" required>
                                    <option value="solo_ver">Solo Ver</option>
                                    <option value="ver_agregar">Ver y Agregar</option>
                                    <option value="superusuario">Superusuario</option>
                                </select>
                            </div>
                        </div>

                        <!-- Botones -->
                        <div class="d-flex justify-content-between mt-4">
                            <button type="button" class="btn btn-primary" onclick="agregarAdministrativo()">
                                <i class="bi bi-person-plus me-1"></i> Agregar
                            </button>                            
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                <i class="bi bi-x-circle me-1"></i> Cancelar
                            </button>                            
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Editar Administrativo -->
    <div class="modal fade" id="modalEditarad" tabindex="-1" aria-labelledby="modalEditarLabelad" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalEditarLabelad">Editar Administrativo</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formEditarad">
                        <input type="hidden" id="edit-idad">

                        <!-- Información Personal -->
                        <h6 class="text-center border-bottom pb-2 mb-3">Información Personal</h6>
                        <div class="row g-2">
                            <div class="col-md-6">
                                <label for="edit-nombread" class="form-label">Nombre</label>
                                <input type="text" id="edit-nombread" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label for="edit-cedulaad" class="form-label">Cédula</label>
                                <input type="text" id="edit-cedulaad" class="form-control">
                            </div>
                        </div>
                        <div class="row g-2 mt-2">
                            <div class="col-md-6">
                                <label for="edit-correoad" class="form-label">Correo</label>
                                <input type="email" id="edit-correoad" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label for="edit-telefonoad" class="form-label">Teléfono</label>
                                <input type="text" id="edit-telefonoad" class="form-control">
                            </div>
                        </div>
                        <div class="row g-2 mt-2">
                            <div class="col-md-6">
                                <label for="edit-celularad" class="form-label">Celular</label>
                                <input type="text" id="edit-celularad" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label for="edit-direccionad" class="form-label">Dirección</label>
                                <input type="text" id="edit-direccionad" class="form-control">
                            </div>
                        </div>

                        <!-- Detalles Profesionales -->
                        <h6 class="text-center border-bottom pb-2 mb-3 mt-3">Detalles Profesionales</h6>
                        <div class="row g-2">
                            <div class="col-md-4">
                                <label for="edit-estadoad" class="form-label">Estado</label>
                                <select id="edit-estadoad" class="form-select" required>
                                    <option value="activo">Activo</option>
                                    <option value="inactivo">Inactivo</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="edit-departamentoad" class="form-label">Departamento</label>
                                <input type="text" id="edit-departamentoad" class="form-control">
                            </div>
                            <div class="col-md-4">
                                <label for="edit-cargoad" class="form-label">Cargo</label>
                                <input type="text" id="edit-cargoad" class="form-control">
                            </div>
                        </div>
                        <div class="row g-2 mt-2">
                            <div class="col-md-6">
                                <label for="edit-fecha-ingresoad" class="form-label">Fecha Ingreso</label>
                                <input type="date" id="edit-fecha-ingresoad" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label for="edit-codigo-admad" class="form-label">Código Adm</label>
                                <input type="text" id="edit-codigo-admad" class="form-control">
                            </div>
                        </div>

                        <!-- Información Adicional -->
                        <h6 class="text-center border-bottom pb-2 mb-3 mt-3">Información Adicional</h6>
                        <div class="row g-2">
                            <div class="col-md-6">
                                <label for="edit-accesoad" class="form-label">Acceso</label>
                                <select id="edit-accesoad" class="form-select" required>
                                    <option value="solo_ver">Solo Ver</option>
                                    <option value="ver_agregar">Ver y Agregar</option>
                                    <option value="superusuario">Superusuario</option>
                                </select>
                            </div>
                        </div>

                        <!-- Botones -->
                        <div class="d-flex justify-content-between mt-4">
                            <button type="button" class="btn btn-primary" onclick="guardarEditarad()">
                                <i class="bi bi-pencil-square me-1"></i> Guardar Cambios
                            </button>                            
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                <i class="bi bi-x-circle me-1"></i> Cancelar
                            </button>                            
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>


<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <div id="course-section" class="dynamic-section">
        <!-- Contenido de cursos -->

        <!-- Modal para crear o editar curso -->
        <div class="modal fade" id="cursoModal" tabindex="-1" aria-labelledby="cursoModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="cursoModalLabel">Nuevo Curso</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="curso-form">
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label for="nombre" class="form-label">Nombre del Curso</label>
                                    <input type="text" id="nombre" class="form-control" required>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="descripcion" class="form-label">Descripción del Curso</label>
                                    <input type="text" id="descripcion" class="form-control" required>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="tipo" class="form-label">Modalidad</label>
                                    <select id="tipo" class="form-select" required>
                                        <option value="curso">Curso</option>
                                        <option value="diplomado">Diplomado</option>
                                    </select>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label for="estado" class="form-label">Estado del Curso</label>
                                    <select id="estado" class="form-select" required>
                                        <option value="activo">Activo</option>
                                        <option value="inactivo">Inactivo</option>
                                    </select>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="tarifa" class="form-label">Costo</label>
                                    <input type="number" id="tarifa" class="form-control" required>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="fecha_inicio" class="form-label">Fecha de Inicio</label>
                                    <input type="date" id="fecha_inicio" class="form-control" required>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label for="fecha_fin" class="form-label">Fecha de Finalización</label>
                                    <input type="date" id="fecha_fin" class="form-control" required>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="capacidad" class="form-label">Capacidad Máxima</label>
                                    <input type="number" id="capacidad" class="form-control" required>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="modulos" class="form-label">Número de Módulos</label>
                                    <input type="number" id="modulos" class="form-control" required>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label for="horas" class="form-label">Total de Horas</label>
                                    <input type="number" id="horas" class="form-control" required>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="codigo" class="form-label">Código del Curso</label>
                                    <input type="text" id="codigo" class="form-control" required>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label for="facultad" class="form-label">Facultad</label>
                                    <select id="facultad" class="form-control" required>
                                        <option value="">Seleccione una facultad</option>
                                        <option value="humanidades">Humanidades</option>
                                        <option value="ciencias">Ciencias</option>
                                        <option value="ciencias_economicas_sociales">Ciencias Económicas y Sociales</option>
                                        <option value="ciencias_juridicas_politicas">Ciencias Jurídicas y Políticas</option>
                                        <option value="ingenieria_arquitectura">Ingeniería y Arquitectura</option>
                                        <option value="ciencias_salud">Ciencias de la Salud</option>
                                        <option value="ciencias_agronomicas_veterinarias">Ciencias Agronómicas y Veterinarias</option>
                                        <option value="artes">Artes</option>
                                        <option value="ciencias_educacion">Ciencias de la Educación</option>
                                    </select>
                                </div>                                
                                <div class="col-md-4 mb-3">
                                    <label for="telefono" class="form-label">Teléfono de Contacto</label>
                                    <input type="text" id="telefono" class="form-control" required>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="docente" class="form-label">Seleccionar Docente</label>
                                    <select id="docente" class="form-select" style="width: 100%;" required></select>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-save me-1"></i> Guardar Curso
                            </button>                            
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lista de cursos -->
        <div class="card mt-4">
            <!-- Botón para abrir el modal de creación -->
            <div class="d-flex justify-content-end mb-3">
                <button id="btnAgregarCursos" class="btn btn-primary d-flex align-items-center gap-1" data-bs-toggle="modal" data-bs-target="#cursoModal" onclick="abrirModal()">
                    <img src="https://i.ibb.co/DKJsFVw/curso.png" alt="Agregar Curso" width="20" height="20">
                    <span>Agregar</span>
                </button>
            </div>
            
            <div class="card-header d-flex justify-content-between align-items-center">
                <span class="text-center flex-grow-1">Listado de Cursos</span>
                <button 
                    class="btn btn-light btn-sm p-0 shadow-sm" 
                    onclick="cargarCursos()" 
                    title="Actualizar" 
                    style="width: 25px; height: 25px; border-radius: 50%;">
                    <i class="bi bi-arrow-clockwise"></i>
                </button>
            </div>            
            <div class="card-body">
                <table id="cursTable" class="table table-striped">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Modalidad</th>
                            <th>Profesor</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="cursos-list"></tbody>
                </table>
            </div>
        </div>
    </div>

<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <div id="registration-section" class="dynamic-section">
        <!-- Contenido de inscripciones -->

        <!-- Modal para crear o editar inscripción -->
        <div class="modal fade" id="inscripcionModal" tabindex="-1" aria-labelledby="inscripcionModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="inscripcionModalLabel">Nueva Inscripción</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="inscripcion-form">
                            <div class="mb-3">
                                <label for="estudiante" class="form-label">Estudiante</label>
                                <select id="estudiante" class="form-select" style="width: 100%;" required></select>
                            </div>
                            <div class="mb-3">
                                <label for="curso" class="form-label">Curso</label>
                                <select id="curso" class="form-select" style="width: 100%;" required></select>
                            </div>                            
                            <div class="mb-3">
                                <label for="estado" class="form-label">Estado</label>
                                <select id="estadoins" class="form-select" required disabled>
                                    <option value="pendiente" selected>Pendiente</option>
                                    <option value="inscrito">Inscrito</option>
                                </select>                                
                            </div>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-save me-1"></i> Guardar
                            </button>                            
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lista de inscripciones -->
        <div class="card mt-4">
            <div class="d-flex justify-content-end mb-3">
                <button id="btnAgregarInscripciones" class="btn btn-primary d-flex align-items-center gap-1" data-bs-toggle="modal" data-bs-target="#inscripcionModal" onclick="abrirModalInscripciones()">
                    <img src="https://i.ibb.co/CsVBMyk/inscripcion.png" alt="Agregar Inscripción" width="20" height="20">
                    <span>Agregar</span>
                </button>
            </div>
            <div class="card-header d-flex justify-content-between align-items-center">
                <span class="text-center flex-grow-1">Lista de Inscripciones</span>
                <button 
                    class="btn btn-light btn-sm p-0 shadow-sm" 
                    onclick="cargarDatostabla()" 
                    title="Actualizar" 
                    style="width: 25px; height: 25px; border-radius: 50%;">
                    <i class="bi bi-arrow-clockwise"></i>
                </button>
            </div>            
            <div class="card-body">
                <table id="inscripTable" class="table table-striped">
                    <thead>
                        <tr>
                            <th>Estudiante</th>
                            <th>Curso</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="inscripciones-list"></tbody>
                </table>
            </div>
        </div>
    </div>

<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <div id="payment-section" class="dynamic-section">
        <!-- Contenido de pagos -->

        <!-- Tabla de Pagos -->
        <div id="tabla-pagos-container" class="card mt-4">
            <div class="d-flex justify-content-end mb-3">
                <button id="btnAgregarPagos" class="btn btn-primary d-flex align-items-center gap-1" onclick="abrirAgregar()">
                    <img src="https://i.ibb.co/r3sKS1M/metodo-de-pago.png" alt="Agregar Pago" width="20" height="20">
                    <span>Agregar</span>
                </button>
            </div>
            
            <div class="card-header d-flex justify-content-between align-items-center">
                <span class="text-center flex-grow-1">Listado de Pagos</span>
                <button 
                    class="btn btn-light btn-sm p-0 shadow-sm" 
                    onclick="cargarPagos()" 
                    title="Actualizar" 
                    style="width: 25px; height: 25px; border-radius: 50%;">
                    <i class="bi bi-arrow-clockwise"></i>
                </button>
            </div>
            <div class="card-body">
                <table id="pagoTable" class="table table-striped mt-4">
                    <thead>
                        <tr>
                            <th>Metodo Pago</th>
                            <th>Estudiante</th> <!-- Aquí se muestra el nombre del estudiante -->
                            <th>Monto</th>
                            <th>Estado Pago</th>
                            <th>Fecha Vencimiento</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="pagos-table-body">
                        <!-- Aquí se cargarán los pagos -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Tabla de Historial -->
        <div id="tabla-historial-container" class="card mt-4" style="display: none;" data-inscripcion-id="">
            <div class="card-header">Historial de Pagos</div>
            <div class="card-body">
                <p id="suma-total-display" class="fw-bold mb-3">Total: RD$0.00</p>
                <table id="historialTable" class="table table-striped mt-4">
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Método Pago</th>
                            <th>Monto</th>
                            <th>Estado Pago</th>
                            <th>Fecha Vencimiento</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="historial-table-body">
                        <!-- Aquí se cargarán los detalles del historial -->
                    </tbody>
                </table>
                <button class="btn btn-secondary mt-3" onclick="alternarTablas(false)">
                    <i class="bi bi-arrow-left-circle-fill"></i> Volver
                </button>
            </div>
        </div>
    </div>


    <!-- Modal Agregar Pago -->
    <div class="modal fade" id="modalAgregarPago" tabindex="-1" aria-labelledby="modalAgregarPagoLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalAgregarPagoLabel">Agregar Pago</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formAgregarPago">
                        <div class="mb-3">
                            <label for="metodo_pago_agregar" class="form-label">Método de Pago</label>
                            <select class="form-control" id="metodo_pago_agregar" required>
                                <option value="transferencia">Transferencia</option>
                                <option value="manual">Manual</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="monto_agregar" class="form-label">Monto</label>
                            <input type="number" class="form-control" id="monto_agregar" required>
                        </div>
                        <div class="mb-3">
                            <label for="estado_pago_agregar" class="form-label">Estado de Pago</label>
                            <select class="form-control" id="estado_pago_agregar" required>
                                <option value="completado">Completado</option>
                                <option value="pendiente">Pendiente</option>
                                <option value="parcial">Parcial</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="fecha_vencimiento_agregar" class="form-label">Fecha de Vencimiento</label>
                            <input type="date" class="form-control" id="fecha_vencimiento_agregar" required>
                        </div>
                        <div class="mb-3">
                            <label for="inscripcion_agregar" class="form-label">Inscripción</label>
                            <select id="inscripcion_agregar" class="form-select" style="width: 100%;" required>
                                <!-- Opciones dinámicas -->
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="guardarNuevoPago()">
                        <i class="bi bi-save me-1"></i> Guardar
                    </button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x me-1"></i> Cerrar
                    </button>                                        
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Editar Pago -->
    <div class="modal fade" id="modalEditarPago" tabindex="-1" aria-labelledby="modalEditarPagoLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalEditarPagoLabel">Editar Pago</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formEditarPago">
                        <input type="hidden" id="pago_id_editar">
                        <div class="mb-3">
                            <label for="metodo_pago_editar" class="form-label">Método de Pago</label>
                            <select class="form-control" id="metodo_pago_editar" required>
                                <option value="transferencia">Transferencia</option>
                                <option value="manual">Manual</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="monto_editar" class="form-label">Monto</label>
                            <input type="number" class="form-control" id="monto_editar" required>
                        </div>
                        <div class="mb-3">
                            <label for="estado_pago_editar" class="form-label">Estado de Pago</label>
                            <select class="form-control" id="estado_pago_editar" required>
                                <option value="pendiente">Pendiente</option>
                                <option value="completado">Completado</option>
                                <option value="parcial">Parcial</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="fecha_vencimiento_editar" class="form-label">Fecha de Vencimiento</label>
                            <input type="date" class="form-control" id="fecha_vencimiento_editar" required>
                        </div>
                        <div class="mb-3">
                            <label for="inscripcion_editar" class="form-label">Inscripción</label>
                            <select id="inscripcion_editar" class="form-select" style="width: 100%;" required>
                                <!-- Opciones dinámicas -->
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="guardarPagoEditado()">
                        <i class="bi bi-pencil me-1"></i> Guardar Cambios
                    </button> 
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle me-1"></i> Cerrar
                    </button>                             
                </div>
            </div>
        </div>
    </div>

  
<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <div id="report-section" class="dynamic-section" style="margin-top: 50px;">
        <!-- Contenido de Informe -->
        <div class="container mt-4">
            <h1 class="text-center"></h1>

            <!-- Contenedor de botones alineados -->
            <div class="d-flex justify-content-center gap-3 my-3 button-container">
                <!-- Botón para recargar la Tabla -->
                <button class="btn btn-warning d-flex align-items-center gap-2" onclick="recargarTabla()">
                    <i class="fas fa-sync-alt"></i>
                    <span>Recargar</span>
                </button>

                <!-- Botón para exportar el informe a PDF -->
                <button class="btn btn-success d-flex align-items-center gap-2" onclick="exportarPDF()">
                    <i class="fas fa-file-pdf"></i>
                    <span>Exportar</span>
                </button>
            </div>

            <!-- Contenido en dos columnas -->
            <div class="row">
                <!-- Tarjeta: Informe de Ingresos por Cursos -->
                <div class="col-md-6">
                    <div class="card mt-4">
                        <div class="card-header text-bg-primary text-white">
                            Informe de Ingresos por Cursos
                        </div>
                        <div class="card-body">
                            <!-- Tabla de los cursos -->
                            <table id="curso-data-table" class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Nombre del Curso</th>
                                        <th>Cantidad de Estudiantes Inscritos</th>
                                        <th>Dinero Recaudado (Monto)</th>
                                    </tr>
                                </thead>
                                <tbody id="curso-table-body">
                                    <!-- Las filas se llenarán dinámicamente -->
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td colspan="2" class="text-end fw-bold">Total Recaudado:</td>
                                        <td id="total-recaudado" class="fw-bold"></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Tarjeta: Informe de Cursos por Año -->
                <div class="col-md-6">
                    <div class="card mt-4">
                        <div class="card-header text-bg-primary text-white">
                            Informe Anual de Ingresos por Cursos
                        </div>
                        <div class="card-body">
                            <!-- Tabla de los cursos por año -->
                            <table id="tabla-cursos-por-ano" class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Año de Inicio</th>
                                        <th>Cantidad de Cursos</th>
                                        <th>Total Recaudado (DOP)</th>
                                    </tr>
                                </thead>
                                <tbody id="cursos-por-ano-body">
                                    <!-- Las filas se llenarán dinámicamente -->
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td colspan="2" class="text-end fw-bold">Total General:</td>
                                        <td id="total-general" class="fw-bold"></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sección de Gráficos en dos columnas -->
            <div class="row mt-4">
                <!-- Gráfico de Histograma -->
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header text-bg-primary text-white">
                            Histograma de Cursos por Año
                        </div>
                        <div class="card-body">
                            <canvas id="histogramChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Gráfico de Barras -->
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header text-bg-primary text-white">
                            Gráfico de Barras: Estudiantes Inscritos
                        </div>
                        <div class="card-body">
                            <canvas id="barChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <!-- Gráfico de Pastel -->
                <div class="col-md-6 mx-auto">
                    <div class="card mb-4">
                        <div class="card-header text-bg-primary text-white">
                            Gráfico de Pastel: Dinero Recaudado
                        </div>
                        <div class="card-body">
                            <canvas id="pieChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <script>
        let inactivityTime = 0;
        const inactivityLimit = 60 * 60 * 1000; 
        let inactivityTimer;

        // Verificar si el usuario ya está autenticado al cargar la página
        window.onload = () => {
            const userLoggedIn = localStorage.getItem('userLoggedIn');
            if (userLoggedIn === 'true') {
                document.getElementById("login-section").style.display = "none";
                document.getElementById("main-menu").style.display = "flex";
                startInactivityTimer(); // Iniciar el temporizador de inactividad
            } else {
                document.getElementById("login-section").style.display = "block";
                document.getElementById("main-menu").style.display = "none";
            }
            resetInactivity(); // Iniciar los eventos de actividad
        }

        // Recuperar accessLevel de localStorage
        function cargarAccessLevel() {
            const storedAccessLevel = localStorage.getItem('accessLevel');
            if (storedAccessLevel) {
                accessLevel = storedAccessLevel;
                console.log('🔄 Nivel de acceso cargado desde localStorage:', accessLevel);
            }
        }

        // Configurar botones dinámicos según accessLevel
        function configurarBotonesEditarEliminar() {
            // Seleccionamos todos los botones dinámicos por clase
            const botonesEditar = document.querySelectorAll('.btn-editar');
            const botonesEliminar = document.querySelectorAll('.btn-eliminar');
            
            botonesEditar.forEach(boton => {
                if (accessLevel === "superusuario") {
                    boton.disabled = false;
                    boton.classList.remove("btn-disabled");
                } else {
                    boton.disabled = true;
                    boton.classList.add("btn-disabled");
                }
            });
            
            botonesEliminar.forEach(boton => {
                if (accessLevel === "superusuario") {
                    boton.disabled = false;
                    boton.classList.remove("btn-disabled");
                } else {
                    boton.disabled = true;
                    boton.classList.add("btn-disabled");
                }
            });
        }

        // Función para habilitar/deshabilitar botones según accessLevel
        function configurarBotones() {
            const botones = [
                "btnAgregarEstudiantes",
                "btnAgregarDocentes",
                "btnAgregarAdministradores",
                "btnAgregarCursos",
                "btnAgregarInscripciones",
                "btnAgregarPagos"
            ];

            // Recorrer cada botón y aplicar la lógica de activación/desactivación
            botones.forEach(id => {
                const boton = document.getElementById(id);

                if (!boton) return; // Si el botón no existe, pasar al siguiente

                switch (accessLevel) {
                    case "solo_ver":
                        boton.disabled = true;
                        boton.classList.add("btn-disabled"); // Clase opcional para indicar visualmente que está desactivado
                        break;
                    case "ver_agregar":
                    case "superusuario":
                        boton.disabled = false;
                        boton.classList.remove("btn-disabled");
                        break;
                    default:
                        console.warn(`🔍 Nivel de acceso desconocido: ${accessLevel}`);
                        boton.disabled = true; // Desactivar por defecto si el nivel es desconocido
                        boton.classList.add("btn-disabled");
                }
            });
        }

        // Llamar a las funciones al cargar la página
        document.addEventListener('DOMContentLoaded', () => {
            cargarAccessLevel(); // Asegurar que se cargue el accessLevel correctamente
            configurarBotonesEditarEliminar(); // Aplicar las condiciones a los botones de Editar y Eliminar
            configurarBotones();

        });

        // Asegurarnos de aplicar las reglas al agregar contenido dinámico
        document.addEventListener('MutationObserver', () => {
            configurarBotonesEditarEliminar();
        });

        // Variable global para almacenar el nivel de acceso
        let accessLevel = null;

        // Función para manejar inicio de sesión
        async function handleLogin() {
            const button = document.getElementById("login-button");
            const codeField = document.getElementById("codigo_adm");
            const passwordField = document.getElementById("password");
            const usernameField = document.getElementById("username");

            const code = codeField.value.trim();
            const password = passwordField.value.trim();

            if (!code || !password) {
                Swal.fire({
                    icon: 'warning', 
                    title: 'Campos incompletos',
                    text: 'Por favor, complete todos los campos antes de continuar.',
                    confirmButtonText: 'Entendido'
                });
                return;
            }

            // Guardar el texto e ícono originales
            const originalHTML = button.innerHTML;

            // Mostrar spinner y deshabilitar botón
            button.disabled = true;
            button.style.cursor = "not-allowed";
            button.innerHTML = '<div class="spinner"></div>';

            try {
                const response = await fetch("https://finalapi.up.railway.app/api/acceso/usuario/", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ codigo_adm: code, password: password }),
                });

                if (response.ok) {
                    const data = await response.json();

                    // Almacenar el nivel de acceso en la variable global
                    accessLevel = data.datos.acceso || null;
                    
                    // Guardar sesión
                    localStorage.setItem("userLoggedIn", "true");

                    // Guardar en localStorage
                    localStorage.setItem('accessLevel', accessLevel);
                    localStorage.setItem('codigo_adm', code); // Guardar el código

                    // Actualizar el texto del menú
                    const menuUserText = document.getElementById("menu-user-text");
                    if (menuUserText) {
                        menuUserText.textContent = code;
                    }

                    // Mostrar código en el campo username
                    usernameField.value = code;

                    // Ocultar login y mostrar el menú principal
                    document.getElementById("login-section").style.display = "none";
                    document.getElementById("main-menu").style.display = "flex";

                    // Restablecer campos y estilos después del inicio exitoso
                    clearInputs();
                    resetInputStyles();

                    // Iniciar temporizador de inactividad
                    startInactivityTimer();

                    // Deshabilitar Enter
                    toggleEnterKey(false);

                    configurarBotones();

                    configurarBotonesEditarEliminar();

                } else {
                    Swal.fire({
                        icon: 'warning',
                        title: 'Credenciales incorrectas',
                        text: 'El código o la contraseña ingresados no son válidos. Por favor, verifíquelos e inténtelo nuevamente.',
                        confirmButtonText: 'Aceptar'
                    });

                    // Limpiar los campos de texto en caso de error
                    clearInputs();
                }
            } catch (error) {
                console.error("Error al iniciar sesión:", error);

                Swal.fire({
                    icon: 'error',
                    title: 'Error al iniciar sesión',
                    text: 'Ocurrió un problema al intentar iniciar sesión. Por favor, inténtelo de nuevo más tarde.',
                    confirmButtonText: 'Aceptar'
                });

                // Limpiar los campos de texto en caso de fallo general
                clearInputs();
            } finally {
                // Restaurar estado original del botón
                button.innerHTML = originalHTML;
                button.disabled = false;
                button.style.cursor = "pointer";
            }

            // Función para limpiar campos de texto
            function clearInputs() {
                codeField.value = '';
                passwordField.value = '';
            }

            // Función para restaurar el estilo original de los campos
            function resetInputStyles() {
                codeField.classList.remove("input-error");
                passwordField.classList.remove("input-error");
                codeField.style.backgroundColor = "#fff";
                passwordField.style.backgroundColor = "#fff";
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            const usernameField = document.getElementById("username");
            const menuUserText = document.getElementById("menu-user-text");
            const storedCode = localStorage.getItem("codigo_adm");

            if (storedCode) {
                usernameField.value = storedCode;
                usernameField.disabled = true;

                // Cambiar texto del menú si el usuario está logueado
                if (localStorage.getItem("userLoggedIn") === "true" && menuUserText) {
                    menuUserText.textContent = storedCode;
                }

                // Mostrar la sección principal si ya está logueado
                if (localStorage.getItem("userLoggedIn") === "true") {
                    document.getElementById("login-section").style.display = "none";
                    document.getElementById("main-menu").style.display = "flex";
                }
            }
        });


        // Variable global para el evento de tecla Enter
        let enterKeyHandler = null;

        // Función global para habilitar y deshabilitar el evento de tecla Enter
        function toggleEnterKey(enable) {
            if (enable) {
                if (!enterKeyHandler) {
                    enterKeyHandler = (event) => {
                        if (event.key === "Enter") {
                            event.preventDefault();  // Evita el comportamiento predeterminado
                            handleLogin();           // Llama a la función de inicio de sesión
                        }
                    };
                    document.addEventListener("keydown", enterKeyHandler);
                }
            } else {
                if (enterKeyHandler) {
                    document.removeEventListener("keydown", enterKeyHandler);
                    enterKeyHandler = null;
                }
            }

            localStorage.setItem("enterEnabled", enable ? "true" : "false"); // Actualizar en localStorage
        }


        document.addEventListener("DOMContentLoaded", () => {
            const userLoggedIn = localStorage.getItem("userLoggedIn") === "true";
            toggleEnterKey(!userLoggedIn);  // Habilitar/Deshabilitar según el estado de sesión
        });


        // Función para manejar cierre de sesión
        function handleLogout() {
            Swal.fire({
                title: '¿Estás seguro?',
                text: 'Se cerrará tu sesión y todos los cambios no guardados podrían perderse.',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Sí, cerrar sesión',
                cancelButtonText: 'Cancelar',
            }).then((result) => {
                if (result.isConfirmed) {
                    // Eliminar el estado de sesión en localStorage
                    localStorage.removeItem('userLoggedIn');

                    localStorage.removeItem('codigo_adm'); // Eliminar el código

                    localStorage.removeItem('accessLevel');

                    // Restablecer el texto del menú
                    const menuUserText = document.getElementById("menu-user-text");
                    if (menuUserText) {
                        menuUserText.textContent = "Usuario";
                    }

                    // Restablecer el campo username
                    document.getElementById("username").value = "";

                    accessLevel = null;

                    // Eliminar la clase "active" de todos los enlaces
                    $('.main-menu a').removeClass('active');

                    // Ocultar el menú principal
                    document.getElementById("main-menu").style.display = "none";

                    // Mostrar el formulario de login
                    document.getElementById("login-section").style.display = "block";

                    // Limpiar los campos de login
                    document.getElementById("codigo_adm").value = "";
                    document.getElementById("password").value = "";

                    // Ocultar todas las secciones dinámicas
                    const dynamicSections = document.querySelectorAll('.dynamic-section');
                    dynamicSections.forEach(function (section) {
                        section.style.display = 'none';
                    });

                    // Ocultar la sección de "Actualizar Contraseña" si está visible
                    const changePasswordSection = document.getElementById('change-password-section');
                    if (changePasswordSection) {
                        changePasswordSection.style.display = 'none';
                    }

                    // Restablecer el temporizador de inactividad
                    resetInactivityTimer();

                    // Asegurarse de ocultar cualquier otra sección activa
                    const allSections = document.querySelectorAll('.main-section');
                    allSections.forEach(function (section) {
                        section.style.display = 'none';
                    });

                    toggleEnterKey(true);  // Activar de nuevo *Enter*

                    // Mostrar notificación de cierre de sesión
                    Swal.fire({
                        icon: 'success',
                        title: 'Sesión cerrada',
                        text: 'Has cerrado sesión exitosamente.',
                        timer: 2000,
                        showConfirmButton: false,
                    });

                    // Opcional: Redirigir al usuario a la página de inicio de sesión
                    // window.location.href = 'login.html'; // Descomenta esto si deseas redirigir

                }
            });
        }

        // Función para mostrar la sección seleccionada y ocultar las demás
        function showSection(sectionId) {
            // Ocultar todas las secciones dinámicas
            const sections = document.querySelectorAll('.dynamic-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });

            // Ocultar la sección de actualización de contraseña si está visible
            const changePasswordSection = document.getElementById('change-password-section');
            if (changePasswordSection) {
                changePasswordSection.style.display = 'none';
            }

            // Mostrar la sección seleccionada
            const sectionToShow = document.getElementById(sectionId);
            if (sectionToShow) {
                sectionToShow.style.display = 'block';
            }

            // Resaltar el enlace del menú activo (si es necesario)
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => {
                item.classList.remove('active');
            });

            // Resaltar el enlace del menú activo correspondiente
            const activeMenuItem = document.querySelector(`a[onclick="showSection('${sectionId}')"]`);
            if (activeMenuItem) {
                activeMenuItem.parentElement.classList.add('active');
            }
        }


        // Ocultar todas las secciones dinámicas
        function hideSections() {
            const sections = document.querySelectorAll('.dynamic-section');
            sections.forEach(section => section.classList.remove('active'));
        }

        // Función para manejar la actividad del usuario
        function resetInactivityTimer() {
            clearTimeout(inactivityTimer);
            inactivityTime = 0;
            startInactivityTimer(); // Reiniciar el temporizador
        }

        // Iniciar el temporizador de inactividad
        function startInactivityTimer() {
            inactivityTimer = setInterval(() => {
                inactivityTime += 1000; // Sumar 1 segundo

                // Si el tiempo de inactividad supera el límite, redirigir al formulario de inicio de sesión
                if (inactivityTime >= inactivityLimit) {
                    handleLogout(); // Cerrar sesión
                    Swal.fire({
                        icon: 'info', // Icono informativo
                        title: 'Sesión cerrada por inactividad',
                        text: 'Has estado inactivo durante demasiado tiempo. Serás redirigido al inicio de sesión.',
                        confirmButtonText: 'Entendido'
                    });
                }

            }, 1000); // Ejecutar cada 1 segundo
        }

        // Detectar actividad del usuario
        function resetInactivity() {
            document.body.addEventListener('mousemove', resetInactivityTimer);
            document.body.addEventListener('keydown', resetInactivityTimer);
            document.body.addEventListener('scroll', resetInactivityTimer);
        }

    </script>

<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <script>
        const apiUrlE = "https://finalapi.up.railway.app/api/estudiantes/";
        let estudiantesTable;

        // Cargar estudiantes y actualizar la tabla
        async function cargarEstudiantes() {
            try {
                const response = await fetch(apiUrlE);
                const estudiantes = await response.json();

                const tableBody = document.getElementById("estudiantes-table-body");
                tableBody.innerHTML = "";

                estudiantes.forEach(estudiante => {
                    const row = document.createElement("tr");
                    row.innerHTML = `
                        <td>${estudiante.matricula}</td>
                        <td>${estudiante.nombre_completo}</td>
                        <td>${estudiante.cedula}</td>
                        <td>${estudiante.correo}</td>
                        <td>${estudiante.telefono}</td>
                        <td>${estudiante.celular}</td>
                        <td>${estudiante.direccion}</td>
                        <td>${estudiante.estado}</td>
                        <td>
                            <!-- Contenedor para los botones alineados -->
                            <div class="d-flex gap-2">
                                <!-- Botón para ver con ícono de Bootstrap -->
                                <button class="btn btn-info btn-sm btn-ver" onclick="verEstudiante(${estudiante.id})">
                                    <i class="bi bi-eye-fill"></i> Ver
                                </button>

                                <!-- Botón para editar con ícono de Bootstrap -->
                                <button class="btn btn-warning btn-sm btn-editar" onclick="editarEstudiante(${estudiante.id})">
                                    <i class="bi bi-pencil-fill"></i> Editar
                                </button>

                                <!-- Botón para eliminar con ícono de Bootstrap -->
                                <button class="btn btn-danger btn-sm btn-eliminar" onclick="eliminarEstudiante(${estudiante.id})">
                                    <i class="bi bi-trash-fill"></i> Eliminar
                                </button>
                            </div>
                        </td>

                    `;
                    tableBody.appendChild(row);
                    configurarBotonesEditarEliminar();
                });

                if (!$.fn.dataTable.isDataTable('#estudiantes-table')) {
                    estudiantesTable = $('#estudiantes-table').DataTable();
                } else {
                    estudiantesTable.clear().draw();
                    estudiantes.forEach(estudiante => {
                        estudiantesTable.row.add([
                            estudiante.matricula,
                            estudiante.nombre_completo,
                            estudiante.cedula,
                            estudiante.correo,
                            estudiante.telefono,
                            estudiante.celular,
                            estudiante.direccion,
                            estudiante.estado,
                            `<!-- Contenedor para los botones alineados -->
                            <div class="d-flex gap-2">
                                <!-- Botón para ver con ícono de Bootstrap -->
                                <button class="btn btn-info btn-sm btn-ver" onclick="verEstudiante(${estudiante.id})">
                                    <i class="bi bi-eye-fill"></i> Ver
                                </button>

                                <!-- Botón para editar con ícono de Bootstrap -->
                                <button class="btn btn-warning btn-sm btn-editar" onclick="editarEstudiante(${estudiante.id})">
                                    <i class="bi bi-pencil-fill"></i> Editar
                                </button>

                                <!-- Botón para eliminar con ícono de Bootstrap -->
                                <button class="btn btn-danger btn-sm btn-eliminar" onclick="eliminarEstudiante(${estudiante.id})">
                                    <i class="bi bi-trash-fill"></i> Eliminar
                                </button>
                            </div>`
                        ]);
                    });
                    estudiantesTable.draw();
                    configurarBotonesEditarEliminar();

                }
            } catch (error) {
                console.error("Error al cargar estudiantes:", error);
            }
        }

        // Abrir modal para agregar estudiante
        function abrirAgregarE() {
            const modalAgregar = new bootstrap.Modal(document.getElementById('modalAgregarE'));
            modalAgregar.show();
        }

        // Guardar estudiante nuevo
        async function guardarAgregarE(event) {
            event.preventDefault();

            const nuevoEstudiante = {
                nombre_completo: document.getElementById("add-nombre").value,
                cedula: document.getElementById("add-cedula").value,
                correo: document.getElementById("add-correo").value,
                telefono: document.getElementById("add-telefono").value,
                celular: document.getElementById("add-celular").value,
                direccion: document.getElementById("add-direccion").value,
                estado: document.getElementById("add-estado").value,
                matricula: document.getElementById("add-matricula").value
            };

            try {
                const response = await fetch(apiUrlE, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(nuevoEstudiante)
                });

                if (response.ok) {
                    Swal.fire({
                        icon: 'success', // Icono de éxito
                        title: 'Estudiante agregado con éxito',
                        text: 'La contraseña será enviada al correo registrado.',
                        confirmButtonText: 'Entendido',
                        timer: 4000, // Tiempo en milisegundos para que se cierre automáticamente
                        timerProgressBar: true // Muestra una barra de progreso
                    });
                    bootstrap.Modal.getInstance(document.getElementById('modalAgregarE')).hide();
                    document.getElementById("add-form").reset();
                    cargarEstudiantes();
                    cargarDatostabla();
                } else {
                    Swal.fire({
                        icon: 'error', // Icono para representar el error
                        title: 'Error',
                        text: 'No se pudo agregar el estudiante. Por favor, inténtalo de nuevo.',
                        confirmButtonText: 'Aceptar',
                        footer: '<a href="/ayuda">¿Necesitas ayuda?</a>' // Enlace opcional para obtener soporte
                    });
                }
            } catch (error) {
                console.error("Error al agregar estudiante:", error);
            }
        }

        // Abrir modal para editar estudiante
        async function editarEstudiante(id) {
            try {
                const response = await fetch(`${apiUrlE}${id}/`);
                const estudiante = await response.json();

                document.getElementById("edit-id").value = estudiante.id;
                document.getElementById("edit-nombre").value = estudiante.nombre_completo;
                document.getElementById("edit-cedula").value = estudiante.cedula;
                document.getElementById("edit-correo").value = estudiante.correo;
                document.getElementById("edit-telefono").value = estudiante.telefono;
                document.getElementById("edit-celular").value = estudiante.celular;
                document.getElementById("edit-direccion").value = estudiante.direccion;
                document.getElementById("edit-estado").value = estudiante.estado;
                document.getElementById("edit-matricula").value = estudiante.matricula;

                const modalEditar = new bootstrap.Modal(document.getElementById('modalEditarE'));
                modalEditar.show();
            } catch (error) {
                console.error("Error al cargar estudiante:", error);
            }
        }

        // Función para ver estudiante
        async function verEstudiante(id) {
            try {
                const response = await fetch(`${apiUrlE}${id}/`);
                const estudiante = await response.json();

                // Llenar los campos del formulario con los datos del estudiante
                document.getElementById("edit-id").value = estudiante.id;
                document.getElementById("edit-nombre").value = estudiante.nombre_completo;
                document.getElementById("edit-cedula").value = estudiante.cedula;
                document.getElementById("edit-correo").value = estudiante.correo;
                document.getElementById("edit-telefono").value = estudiante.telefono;
                document.getElementById("edit-celular").value = estudiante.celular;
                document.getElementById("edit-direccion").value = estudiante.direccion;
                document.getElementById("edit-estado").value = estudiante.estado;
                document.getElementById("edit-matricula").value = estudiante.matricula;

                // Bloquear todos los campos y botones
                const inputs = document.querySelectorAll('#edit-form input, #edit-form select, #edit-form button');
                inputs.forEach(input => input.disabled = true);

                // Cambiar el título del formulario
                const modalTitle = document.querySelector('#modalEditarE .modal-title');
                const originalTitle = modalTitle.textContent; // Guardar el título original
                modalTitle.textContent = "Ver Estudiante";

                // Mostrar el modal
                const modalEditar = new bootstrap.Modal(document.getElementById('modalEditarE'));
                modalEditar.show();

                // Restablecer el formulario al cerrarse el modal
                document.getElementById('modalEditarE').addEventListener('hidden.bs.modal', () => {
                    document.getElementById("edit-form").reset(); // Limpiar el formulario
                    inputs.forEach(input => input.disabled = false); // Habilitar los campos y botones
                    modalTitle.textContent = originalTitle; // Restaurar el título original
                }, { once: true });

            } catch (error) {
                console.error("Error al cargar estudiante:", error);
            }
        }

        // Guardar cambios al editar estudiante
        async function guardarEditarE(event) {
            event.preventDefault();

            const id = document.getElementById("edit-id").value;
            const estudianteActualizado = {
                nombre_completo: document.getElementById("edit-nombre").value,
                cedula: document.getElementById("edit-cedula").value,
                correo: document.getElementById("edit-correo").value,
                telefono: document.getElementById("edit-telefono").value,
                celular: document.getElementById("edit-celular").value,
                direccion: document.getElementById("edit-direccion").value,
                estado: document.getElementById("edit-estado").value,
                matricula: document.getElementById("edit-matricula").value
            };

            try {
                const response = await fetch(`${apiUrlE}${id}/`, {
                    method: "PUT",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(estudianteActualizado)
                });

                if (response.ok) {
                    Swal.fire({
                        icon: 'success', // Icono para indicar éxito
                        title: '¡Éxito!',
                        text: 'El estudiante ha sido actualizado con éxito.',
                        confirmButtonText: 'Aceptar', // Botón claro y conciso
                        timer: 3000, // Tiempo en milisegundos para cerrar automáticamente
                        timerProgressBar: true // Barra de progreso visual mientras se cuenta el tiempo
                    });
                    bootstrap.Modal.getInstance(document.getElementById('modalEditarE')).hide();
                    cargarEstudiantes();
                } else {
                    Swal.fire({
                        icon: 'error', // Indica visualmente que se trata de un error
                        title: 'Error',
                        text: 'Ocurrió un problema al actualizar el estudiante. Por favor, inténtalo de nuevo.',
                        confirmButtonText: 'Aceptar', // Botón claro y directo
                        timer: 5000, // Tiempo para cerrar automáticamente en milisegundos
                        timerProgressBar: true // Barra de progreso para el tiempo restante
                    });
                }
            } catch (error) {
                console.error("Error al actualizar estudiante:", error);
            }
        }

        // Función para eliminar estudiante
        async function eliminarEstudiante(id) {
            const result = await Swal.fire({
                title: '¿Estás seguro?',
                text: "No podrás deshacer esta acción",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Sí, eliminar',
                cancelButtonText: 'Cancelar'
            });

            if (result.isConfirmed) {
                try {
                    const response = await fetch(`${apiUrlE}${id}/`, { method: "DELETE" });

                    if (response.ok) {
                        await Swal.fire(
                            'Eliminado',
                            'El estudiante ha sido eliminado con éxito.',
                            'success'
                        );
                        cargarEstudiantes();
                    } else {
                        Swal.fire(
                            'Error',
                            'No se pudo eliminar el estudiante.',
                            'error'
                        );
                    }
                } catch (error) {
                    console.error("Error:", error);
                    Swal.fire(
                        'Error',
                        'Hubo un problema de conexión.',
                        'error'
                    );
                }
            }
        }

        cargarEstudiantes();
    </script>


<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <script>
        const apiUrlD = "https://finalapi.up.railway.app/api/docentes/";
        let docentesTable;  // Guardamos la instancia de DataTable aquí

        // Cargar docentes desde el API
        async function cargarDocent() {
            try {
                const response = await fetch(apiUrlD);
                const docentes = await response.json();
                const tableBody = document.querySelector("#docentes-table tbody");
                tableBody.innerHTML = "";

                docentes.forEach(docente => {
                    const row = document.createElement("tr");

                    row.innerHTML = `
                        <td>${docente.nombre_completo}</td>
                        <td>${docente.cedula}</td>
                        <td>${docente.correo}</td>
                        <td>${docente.telefono}</td>
                        <td>${docente.estatus}</td>
                        <td>${docente.codigo}</td>
                        <td>
                            <!-- Contenedor para los botones alineados -->
                            <div class="d-flex gap-2">
                                <!-- Botón para ver con ícono de Bootstrap -->
                                <button class="btn btn-info btn-sm custom-btn btn-ver" onclick="verDocente(${docente.id})">
                                    <i class="bi bi-eye-fill"></i> Ver
                                </button>

                                <!-- Botón para editar con ícono de Bootstrap -->
                                <button class="btn btn-warning btn-sm custom-btn btn-editar" onclick="abrirEdit(${docente.id})">
                                    <i class="bi bi-pencil-fill"></i> Editar
                                </button>

                                <!-- Botón para eliminar con ícono de Bootstrap -->
                                <button class="btn btn-danger btn-sm custom-btn btn-eliminar" onclick="eliminarDocente(${docente.id})">
                                    <i class="bi bi-trash-fill"></i> Eliminar
                                </button>
                            </div>
                        </td>

                    `;
                    tableBody.appendChild(row);
                    configurarBotonesEditarEliminar();
                });

                // Si el DataTable no está inicializado, inicializarlo
                if (!$.fn.dataTable.isDataTable('#docentes-table')) {
                    docentesTable = $('#docentes-table').DataTable({
                        "searching": true, // Habilita la búsqueda
                        "paging": true,    // Habilita la paginación
                        "ordering": true,  // Habilita el ordenamiento de columnas
                        "info": true       // Muestra información sobre la tabla (ej. "Mostrando 1 de 10")
                    });
                } else {
                    // Si ya está inicializado, recargar los datos
                    docentesTable.clear();
                    docentes.forEach(docente => {
                        docentesTable.row.add([
                            docente.nombre_completo,
                            docente.cedula,
                            docente.correo,
                            docente.telefono,
                            docente.estatus,
                            docente.codigo,
                            `<td>
                                <!-- Contenedor para los botones alineados -->
                                <div class="d-flex gap-2">
                                    <!-- Botón para ver con ícono de Bootstrap -->
                                    <button class="btn btn-info btn-sm custom-btn btn-ver" onclick="verDocente(${docente.id})">
                                        <i class="bi bi-eye-fill"></i> Ver
                                    </button>

                                    <!-- Botón para editar con ícono de Bootstrap -->
                                    <button class="btn btn-warning btn-sm custom-btn btn-editar" onclick="abrirEdit(${docente.id})">
                                        <i class="bi bi-pencil-fill"></i> Editar
                                    </button>

                                    <!-- Botón para eliminar con ícono de Bootstrap -->
                                    <button class="btn btn-danger btn-sm custom-btn btn-eliminar" onclick="eliminarDocente(${docente.id})">
                                        <i class="bi bi-trash-fill"></i> Eliminar
                                    </button>
                                </div>
                            </td>
                        `]);
                    });
                    docentesTable.draw();  // Actualizar la tabla con los nuevos datos
                    configurarBotonesEditarEliminar();
                }

            } catch (error) {
                console.error("Error al cargar docentes:", error);
            }
        }

        // Abrir modal para agregar
        function abrirAgr() {
            // Limpiar el campo id del docente para asegurar que es un nuevo docente
            document.getElementById("docente-id").value = "";

            // Limpiar los campos del formulario
            document.getElementById("nombre_completod").value = "";
            document.getElementById("cedulad").value = "";
            document.getElementById("correod").value = "";
            document.getElementById("telefonod").value = "";
            document.getElementById("celulard").value = "";
            document.getElementById("direcciond").value = "";
            document.getElementById("especialidadd").value = "";
            document.getElementById("fecha_contratacion").value = "";
            document.getElementById("facultadd").value = "";
            document.getElementById("escuelad").value = "";
            document.getElementById("campusd").value = "";
            document.getElementById("codigo_doc").value = "";
            document.getElementById("estatusd").value = "activo";  // Por defecto, activo
            document.getElementById("codigod").value = "invitado"; // Por defecto, invitado

            // Cambiar el título del modal a "Agregar Docente"
            document.getElementById("modalDocenteLabel").innerText = "Agregar Docente";

            // Mostrar el modal
            const modalDocente = new bootstrap.Modal(document.getElementById('modalDocente'));
            modalDocente.show();
        }

        // Abrir modal para editar
        async function abrirEdit(id) {
            try {
                const response = await fetch(`${apiUrlD}${id}/`);
                const docente = await response.json();

                document.getElementById("docente-id").value = docente.id;
                document.getElementById("nombre_completod").value = docente.nombre_completo;
                document.getElementById("cedulad").value = docente.cedula;
                document.getElementById("correod").value = docente.correo;
                document.getElementById("telefonod").value = docente.telefono;
                document.getElementById("celulard").value = docente.celular;
                document.getElementById("direcciond").value = docente.direccion;
                document.getElementById("especialidadd").value = docente.especialidad;
                document.getElementById("fecha_contratacion").value = docente.fecha_contratacion;
                document.getElementById("facultadd").value = docente.facultad;
                document.getElementById("escuelad").value = docente.escuela;
                document.getElementById("campusd").value = docente.campus;
                document.getElementById("codigo_doc").value = docente.codigo_doc;
                document.getElementById("estatusd").value = docente.estatus;
                document.getElementById("codigod").value = docente.codigo;

                // Cambiar el título del modal
                document.getElementById("modalDocenteLabel").textContent = "Editar Docente";

                // Mostrar el modal
                const modalDocente = new bootstrap.Modal(document.getElementById('modalDocente'));
                modalDocente.show();

            } catch (error) {
                console.error("Error al cargar docente:", error);
            }
        }

        document.getElementById('modalDocente').addEventListener('hidden.bs.modal', () => {
            // Restaurar el título a "Agregar Docente"
            document.getElementById("modalDocenteLabel").textContent = "Agregar Docente";
        });

        // Abrir modal para ver docente
        async function verDocente(id) {
            try {
                const response = await fetch(`${apiUrlD}${id}/`);
                const docente = await response.json();

                document.getElementById("docente-id").value = docente.id;
                document.getElementById("nombre_completod").value = docente.nombre_completo;
                document.getElementById("cedulad").value = docente.cedula;
                document.getElementById("correod").value = docente.correo;
                document.getElementById("telefonod").value = docente.telefono;
                document.getElementById("celulard").value = docente.celular;
                document.getElementById("direcciond").value = docente.direccion;
                document.getElementById("especialidadd").value = docente.especialidad;
                document.getElementById("fecha_contratacion").value = docente.fecha_contratacion;
                document.getElementById("facultadd").value = docente.facultad;
                document.getElementById("escuelad").value = docente.escuela;
                document.getElementById("campusd").value = docente.campus;
                document.getElementById("codigo_doc").value = docente.codigo_doc;
                document.getElementById("estatusd").value = docente.estatus;
                document.getElementById("codigod").value = docente.codigo;

                // Bloquear todos los campos y botones del formulario
                const formElements = document.querySelectorAll('#modalDocente input, #modalDocente select, #modalDocente button');
                formElements.forEach(el => el.disabled = true);

                // Cambiar el título del modal
                document.getElementById("modalDocenteLabel").textContent = "Ver Docente";

                // Mostrar el modal
                const modalDocente = new bootstrap.Modal(document.getElementById('modalDocente'));
                modalDocente.show();

                // Restaurar el formulario al cerrar el modal
                document.getElementById('modalDocente').addEventListener('hidden.bs.modal', () => {
                    formElements.forEach(el => el.disabled = false);
                    document.getElementById("docente-id").value = '';
                    document.getElementById("nombre_completod").value = '';
                    document.getElementById("cedulad").value = '';
                    document.getElementById("correod").value = '';
                    document.getElementById("telefonod").value = '';
                    document.getElementById("celulard").value = '';
                    document.getElementById("direcciond").value = '';
                    document.getElementById("especialidadd").value = '';
                    document.getElementById("fecha_contratacion").value = '';
                    document.getElementById("facultadd").value = '';
                    document.getElementById("escuelad").value = '';
                    document.getElementById("campusd").value = '';
                    document.getElementById("codigo_doc").value = '';
                    document.getElementById("estatusd").value = '';
                    document.getElementById("codigod").value = '';
                });
            } catch (error) {
                console.error("Error al cargar docente:", error);
            }
        }
        
        // Guardar docente (agregar o editar)
        async function guardarDocente(event) {
            event.preventDefault();

            const id = document.getElementById("docente-id").value;
            const docente = {
                nombre_completo: document.getElementById("nombre_completod").value,
                cedula: document.getElementById("cedulad").value,
                correo: document.getElementById("correod").value,
                telefono: document.getElementById("telefonod").value,
                celular: document.getElementById("celulard").value,
                direccion: document.getElementById("direcciond").value,
                estado: "activo", // Forzar siempre el estado como activo
                especialidad: document.getElementById("especialidadd").value,
                fecha_contratacion: document.getElementById("fecha_contratacion").value,
                facultad: document.getElementById("facultadd").value,
                escuela: document.getElementById("escuelad").value,
                campus: document.getElementById("campusd").value,
                codigo_doc: document.getElementById("codigo_doc").value,
                estatus: document.getElementById("estatusd").value,
                codigo: document.getElementById("codigod").value
            };

            const method = id ? "PUT" : "POST"; // Usa PUT si hay un ID (editar) o POST si no hay ID (agregar)
            const url = id ? `${apiUrlD}${id}/` : apiUrlD;

            try {
                const response = await fetch(url, {
                    method,
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(docente)
                });

                if (response.ok) {
                    Swal.fire({
                        icon: 'success', // Icono para resaltar el éxito
                        title: '¡Operación exitosa!',
                        text: 'El docente se ha agregado con éxito. La contraseña será enviada al correo registrado.',
                        confirmButtonText: 'Aceptar', // Botón claro y conciso
                        timer: 5000, // El mensaje se cerrará automáticamente después de 5 segundos
                        timerProgressBar: true // Muestra una barra de progreso durante el tiempo del temporizador
                    });
                    cargarDocent();  // Recargar la lista de docentes
                    limpiarFormularioDo();
                    cargarDocentes();
                    document.getElementById("modalDocente").querySelector(".btn-close").click();  // Cerrar modal
                } else {
                    Swal.fire({
                        icon: 'error', // Icono que indica un problema
                        title: 'Error',
                        text: 'Ocurrió un problema al intentar guardar al docente. Por favor, inténtalo nuevamente.',
                        confirmButtonText: 'Cerrar', // Botón accesible para el usuario
                        timer: 5000, // Mensaje se cierra automáticamente después de 5 segundos
                        timerProgressBar: true // Muestra barra de progreso mientras el temporizador corre
                    });
                }
            } catch (error) {
                console.error("Error:", error);
            }
        }
        // Limpiar el formulario de agregar
        function limpiarFormularioDo() {
            document.getElementById("docente-form").reset();
        }

        // Eliminar docente
        async function eliminarDocente(id) {
            const result = await Swal.fire({
                title: '¿Estás seguro?',
                text: "No podrás revertir esta acción",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Sí, eliminar',
                cancelButtonText: 'Cancelar'
            });

            if (result.isConfirmed) {
                try {
                    const response = await fetch(`${apiUrlD}${id}/`, { method: "DELETE" });
                    if (response.ok) {
                        Swal.fire(
                            'Eliminado',
                            'El docente ha sido eliminado.',
                            'success'
                        );
                        cargarDocentes();
                        cargarDocent();
                    } else {
                        Swal.fire(
                            'Error',
                            'Hubo un problema al eliminar el docente.',
                            'error'
                        );
                    }
                } catch (error) {
                    console.error("Error:", error);
                    Swal.fire(
                        'Error',
                        'Hubo un problema con la conexión.',
                        'error'
                    );
                }
            }
        }

        cargarDocent();
    </script>

<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <script>
        const apiUrlad = "https://finalapi.up.railway.app/api/administrativos/";
        let adminTable; // Instancia de DataTable

        // Cargar administrativos
        async function cargarAdministrativos() {
            try {
                const response = await fetch(apiUrlad);
                const administrativos = await response.json();
                const tableBody = document.querySelector("#table-body");
                tableBody.innerHTML = ""; // Limpiar la tabla

                administrativos.forEach(admin => {
                    const row = document.createElement("tr");

                    // Crear celdas
                    const cellNombre = document.createElement("td");
                    cellNombre.textContent = admin.nombre_completo;

                    const cellCedula = document.createElement("td");
                    cellCedula.textContent = admin.cedula;

                    const cellCorreo = document.createElement("td");
                    cellCorreo.textContent = admin.correo;

                    const cellTelefono = document.createElement("td");
                    cellTelefono.textContent = admin.telefono;

                    const cellCelular = document.createElement("td");
                    cellCelular.textContent = admin.celular;

                    const cellDireccion = document.createElement("td");
                    cellDireccion.textContent = admin.direccion;

                    const cellDepartamento = document.createElement("td");
                    cellDepartamento.textContent = admin.departamento;

                    const cellCargo = document.createElement("td");
                    cellCargo.textContent = admin.cargo;

                    const cellCodigoAdm = document.createElement("td");
                    cellCodigoAdm.textContent = admin.codigo_adm;

                    const cellEstado = document.createElement("td");
                    cellEstado.textContent = admin.estado;

                    const cellFechaIngreso = document.createElement("td");
                    cellFechaIngreso.textContent = admin.fecha_ingreso;

                    // Celdas de acciones
                    const cellAcciones = document.createElement("td");

                    // Crear el botón de ver con imagen
                    const btnVer = document.createElement("button");
                    btnVer.classList.add("btn", "btn-info", "btn-sm", "ustom-btn", "btn-ver");
                    btnVer.onclick = () => verAdministrativo(admin.id);

                    // Agregar el ícono de Bootstrap al botón de ver
                    const iconVer = document.createElement("i");
                    iconVer.classList.add("bi", "bi-eye-fill"); // Ícono de ojo
                    btnVer.appendChild(iconVer);
                    btnVer.appendChild(document.createTextNode(" Ver"));

                    // Crear el botón de editar con imagen
                    const btnEditar = document.createElement("button");
                    btnEditar.classList.add("btn", "btn-warning", "btn-sm", "custom-btn", "btn-editar");
                    btnEditar.onclick = () => editarAdministrativo(admin.id);

                    // Agregar el ícono de Bootstrap al botón de editar
                    const iconEditar = document.createElement("i");
                    iconEditar.classList.add("bi", "bi-pencil-fill"); // Ícono de lápiz
                    btnEditar.appendChild(iconEditar);
                    btnEditar.appendChild(document.createTextNode(" Editar"));

                    // Crear el botón de eliminar con imagen
                    const btnEliminar = document.createElement("button");
                    btnEliminar.classList.add("btn", "btn-danger", "btn-sm", "custom-btn", "btn-eliminar");
                    btnEliminar.onclick = () => eliminarAdministrativo(admin.id);

                    // Agregar el ícono de Bootstrap al botón de eliminar
                    const iconEliminar = document.createElement("i");
                    iconEliminar.classList.add("bi", "bi-trash-fill"); // Ícono de cubo de basura
                    btnEliminar.appendChild(iconEliminar);
                    btnEliminar.appendChild(document.createTextNode(" Eliminar"));

                    // Crear un contenedor para los botones (flexbox para alinearlos horizontalmente)
                    const buttonContainer = document.createElement("div");
                    buttonContainer.classList.add("d-flex", "gap-2"); // Asegura que los botones estén uno al lado del otro
                    buttonContainer.appendChild(btnVer);
                    buttonContainer.appendChild(btnEditar);
                    buttonContainer.appendChild(btnEliminar);

                    // Añadir los botones al contenedor de celdas
                    cellAcciones.appendChild(buttonContainer);

                    // Agregar todas las celdas a la fila
                    row.appendChild(cellNombre);
                    row.appendChild(cellCedula);
                    row.appendChild(cellCorreo);
                    row.appendChild(cellTelefono);
                    row.appendChild(cellCelular);
                    row.appendChild(cellDireccion);
                    row.appendChild(cellDepartamento);
                    row.appendChild(cellCargo);
                    row.appendChild(cellCodigoAdm);
                    row.appendChild(cellEstado);
                    row.appendChild(cellFechaIngreso)
                    row.appendChild(cellAcciones);

                    // Agregar la fila a la tabla
                    tableBody.appendChild(row);
                    configurarBotonesEditarEliminar();
                });

                if (!$.fn.dataTable.isDataTable('#adminTable')) {
                    adminTable = $('#adminTable').DataTable({
                        "searching": true, // Habilita la búsqueda
                        "paging": true,    // Habilita la paginación
                        "ordering": true,  // Habilita el ordenamiento de columnas
                        "info": true       // Muestra información sobre la tabla (ej. "Mostrando 1 de 10")
                    });
                } else {
                    // Si ya está inicializado, recargar los datos
                    adminTable.clear();
                    administrativos.forEach(admin => {
                        adminTable.row.add([
                        admin.nombre_completo,
                        admin.cedula,
                        admin.correo,
                        admin.telefono,
                        admin.celular,
                        admin.direccion,
                        admin.departamento,
                        admin.cargo,
                        admin.codigo_adm,
                        admin.estado,
                        admin.fecha_ingreso,
                        `<div class="d-flex gap-2">
                            <!-- Botón Ver con ícono de Bootstrap -->
                            <button class="btn btn-info btn-sm custom-btn btn-ver" onclick="verAdministrativo(${admin.id})">
                                <i class="bi bi-eye-fill"></i> Ver
                            </button>

                            <!-- Botón Editar con ícono de Bootstrap -->
                            <button class="btn btn-warning btn-sm btn-editar" onclick="editarAdministrativo(${admin.id})">
                                <i class="bi bi-pencil-fill"></i> Editar
                            </button>

                            <!-- Botón Eliminar con ícono de Bootstrap -->
                            <button class="btn btn-danger btn-sm btn-eliminar" onclick="eliminarAdministrativo(${admin.id})">
                                <i class="bi bi-trash-fill"></i> Eliminar
                            </button>
                        <div class="d-flex gap-2">`
                        ]);
                    });
                    adminTable.draw();  // Actualizar la tabla con los nuevos datos
                    configurarBotonesEditarEliminar()
                }

            } catch (error) {
                console.error("Error al cargar administrativos:", error);
            }
        }

        // Modal Agregar
        function abrirAgregarad() {
            const modalAgregar = new bootstrap.Modal(document.getElementById('modalAgregarad'));
            modalAgregar.show();
        }

        // Agregar administrativo
        async function agregarAdministrativo() {
            event.preventDefault();

            const data = {
                nombre_completo: document.getElementById("add-nombread").value,
                cedula: document.getElementById("add-cedulaad").value,
                correo: document.getElementById("add-correoad").value,
                telefono: document.getElementById("add-telefonoad").value,
                celular: document.getElementById("add-celularad").value,
                direccion: document.getElementById("add-direccionad").value,
                estado: document.getElementById("add-estadoad").value,
                departamento: document.getElementById("add-departamentoad").value,
                cargo: document.getElementById("add-cargoad").value,
                fecha_ingreso: document.getElementById("add-fecha-ingresoad").value,
                codigo_adm: document.getElementById("add-codigo-admad").value,
                acceso: document.getElementById("add-accesoad").value
            };

            try {
                const response = await fetch(apiUrlad, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data),
                });

                if (response.ok) {
                    Swal.fire({
                        icon: 'success', // Icono de éxito
                        title: 'Administrador agregado con éxito',
                        text: 'La contraseña será enviada al correo registrado.',
                        confirmButtonText: 'Aceptar', // Botón para que el usuario cierre la alerta
                        timer: 5000, // Cierra el mensaje automáticamente en 5 segundos
                        timerProgressBar: true, // Barra de progreso mientras se cierra la alerta automáticamente
                        showConfirmButton: true // Asegura que el botón 'Aceptar' siempre se vea
                    });
                    const modalAgregar = new bootstrap.Modal(document.getElementById('modalAgregarad'));
                    modalAgregar.hide();
                    limpiarFormulario();
                    cargarAdministrativos();
                } else {
                    const errorData = await response.json();
                    console.error("Error al agregar administrativo:", errorData);
                    Swal.fire({
                        title: 'Error',
                        text: errorData.message || "No se pudo agregar el administrativo.",
                        icon: 'error',
                        confirmButtonText: 'Aceptar'
                    });
                }
            } catch (error) {
                console.error("Error al agregar administrativo:", error);
                Swal.fire({
                    icon: 'error', // Icono de error
                    title: 'Error',
                    text: 'Ocurrió un error al intentar agregar el administrativo.',
                    confirmButtonText: 'Aceptar', // Botón de aceptación
                    showConfirmButton: true, // Siempre muestra el botón de confirmación
                    timer: 5000, // Cierra el mensaje automáticamente en 5 segundos
                    timerProgressBar: true // Barra de progreso mientras se cierra automáticamente
                });
            }
        }

        // Limpiar el formulario de agregar
        function limpiarFormulario() {
            document.getElementById("formAgregarad").reset();
        }

        // Editar administrativo
        async function editarAdministrativo(id) {
            try {
                const response = await fetch(`${apiUrlad}${id}/`);
                const admin = await response.json();
                document.getElementById("edit-idad").value = id;
                document.getElementById("edit-nombread").value = admin.nombre_completo;
                document.getElementById("edit-cedulaad").value = admin.cedula;
                document.getElementById("edit-correoad").value = admin.correo;
                document.getElementById("edit-telefonoad").value = admin.telefono;
                document.getElementById("edit-celularad").value = admin.celular;
                document.getElementById("edit-direccionad").value = admin.direccion;
                document.getElementById("edit-estadoad").value = admin.estado;
                document.getElementById("edit-departamentoad").value = admin.departamento;
                document.getElementById("edit-cargoad").value = admin.cargo;
                document.getElementById("edit-fecha-ingresoad").value = admin.fecha_ingreso;
                document.getElementById("edit-codigo-admad").value = admin.codigo_adm;
                document.getElementById("edit-accesoad").value = admin.acceso;

                const modalEditar = new bootstrap.Modal(document.getElementById('modalEditarad'));
                modalEditar.show();
            } catch (error) {
                console.error("Error al cargar administrativo:", error);
            }
        }

        // Función para ver administrativo
        async function verAdministrativo(id) {
            try {
                const response = await fetch(`${apiUrlad}${id}/`);
                const admin = await response.json();

                // Llenar los campos del formulario con los datos del administrador
                document.getElementById("edit-idad").value = id;
                document.getElementById("edit-nombread").value = admin.nombre_completo;
                document.getElementById("edit-cedulaad").value = admin.cedula;
                document.getElementById("edit-correoad").value = admin.correo;
                document.getElementById("edit-telefonoad").value = admin.telefono;
                document.getElementById("edit-celularad").value = admin.celular;
                document.getElementById("edit-direccionad").value = admin.direccion;
                document.getElementById("edit-estadoad").value = admin.estado;
                document.getElementById("edit-departamentoad").value = admin.departamento;
                document.getElementById("edit-cargoad").value = admin.cargo;
                document.getElementById("edit-fecha-ingresoad").value = admin.fecha_ingreso;
                document.getElementById("edit-codigo-admad").value = admin.codigo_adm;
                document.getElementById("edit-accesoad").value = admin.acceso;

                // Bloquear todos los campos del formulario
                const form = document.querySelector("#formEditarad");
                const inputs = form.querySelectorAll("input, select, button");
                inputs.forEach(input => {
                    if (input.type !== "hidden") {
                        input.disabled = true;
                    }
                });

                // Cambiar el título del formulario
                const modalTitle = document.querySelector('#modalEditarad .modal-title');
                const originalTitle = modalTitle.textContent; // Guardar el título original
                modalTitle.textContent = "Ver Administrativo";

                // Mostrar el modal
                const modalVer = new bootstrap.Modal(document.getElementById('modalEditarad'));
                modalVer.show();

                // Restablecer el formulario al cerrarse el modal
                document.getElementById('modalEditarad').addEventListener('hidden.bs.modal', () => {
                    // Restablecer el título
                    modalTitle.textContent = originalTitle;

                    // Limpiar el formulario
                    form.reset();

                    // Habilitar campos y botones
                    inputs.forEach(input => input.disabled = false);
                }, { once: true });

            } catch (error) {
                console.error("Error al cargar administrativo:", error);
            }
        }

        // Guardar cambios de administrativo
        async function guardarEditarad() {
            event.preventDefault();

            const id = document.getElementById("edit-idad").value;
            const data = {
                nombre_completo: document.getElementById("edit-nombread").value,
                cedula: document.getElementById("edit-cedulaad").value,
                correo: document.getElementById("edit-correoad").value,
                telefono: document.getElementById("edit-telefonoad").value,
                celular: document.getElementById("edit-celularad").value,
                direccion: document.getElementById("edit-direccionad").value,
                estado: document.getElementById("edit-estadoad").value,
                departamento: document.getElementById("edit-departamentoad").value,
                cargo: document.getElementById("edit-cargoad").value,
                fecha_ingreso: document.getElementById("edit-fecha-ingresoad").value,
                codigo_adm: document.getElementById("edit-codigo-admad").value,
                acceso: document.getElementById("edit-accesoad").value
            };

            try {
                const response = await fetch(`${apiUrlad}${id}/`, {
                    method: "PUT",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data),
                });

                if (response.ok) {
                    Swal.fire({
                        icon: 'success', // Icono de éxito
                        title: 'Éxito',
                        text: 'Administrador editado con éxito.',
                        confirmButtonText: 'Aceptar', // Botón de aceptación
                        showConfirmButton: true, // Siempre muestra el botón de confirmación
                        timer: 4000, // Cierra el mensaje automáticamente en 4 segundos
                        timerProgressBar: true // Barra de progreso mientras se cierra automáticamente
                    });
                    const modalEditar = new bootstrap.Modal(document.getElementById('modalEditarad'));
                    modalEditar.hide();
                    cargarAdministrativos();
                } else {
                    console.error("Error al actualizar administrativo:", response);
                    Swal.fire({
                        icon: 'error', // Icono de error
                        title: 'Oops...',
                        text: 'No se pudo actualizar el administrativo.',
                        confirmButtonText: 'Aceptar', // Botón de aceptación
                        showConfirmButton: true, // Siempre muestra el botón de confirmación
                        timer: 5000, // Cierra el mensaje automáticamente en 5 segundos
                        timerProgressBar: true // Barra de progreso mientras se cierra automáticamente
                    });
                }
            } catch (error) {
                console.error("Error al actualizar administrativo:", error);
                Swal.fire({
                    icon: 'error', // Icono de error
                    title: '¡Error!',
                    text: 'Ocurrió un error al intentar actualizar el administrativo.',
                    confirmButtonText: 'Aceptar', // Botón de aceptación
                    showConfirmButton: true, // Siempre muestra el botón de confirmación
                    timer: 5000, // Cierra el mensaje automáticamente en 5 segundos
                    timerProgressBar: true // Barra de progreso mientras se cierra automáticamente
                });
            }
        }

        // Eliminar administrativo
        async function eliminarAdministrativo(id) {
            const result = await Swal.fire({
                title: '¿Estás seguro?',
                text: "Esta acción no se puede deshacer.",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Sí, eliminar',
                cancelButtonText: 'Cancelar'
            });

            if (result.isConfirmed) {
                try {
                    const response = await fetch(`${apiUrlad}${id}/`, { method: "DELETE" });

                    if (response.ok) {
                        Swal.fire(
                            'Eliminado',
                            'El administrativo ha sido eliminado con éxito.',
                            'success'
                        );
                        cargarAdministrativos();
                    } else {
                        console.error("Error al eliminar administrativo:", response);
                        Swal.fire(
                            'Error',
                            'No se pudo eliminar el administrativo.',
                            'error'
                        );
                    }
                } catch (error) {
                    console.error("Error al eliminar administrativo:", error);
                    Swal.fire(
                        'Error',
                        'Ocurrió un error al intentar eliminar el administrativo.',
                        'error'
                    );
                }
            }
        }

        // Inicializar tabla al cargar la página
        cargarAdministrativos(); // Inicialización
    </script>


<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->


    <script>
        const API_BASEC = 'https://finalapi.up.railway.app/api/';
        let editandoIdC = null;
        let cursosTable;
        let docentesMap = new Map();

        async function inicializarDocenteSelect() {
            $('#docente').select2({
                placeholder: 'Seleccione o escriba un docente',
                allowClear: true,
                tags: true,
                width: 'resolve',
                dropdownParent: $('#cursoModal')
            });
        }

        async function cargarDocentes() {
            try {
                const res = await axios.get(`${API_BASEC}docentes/`);
                const docenteSelect = document.getElementById('docente');
                docenteSelect.innerHTML = '';
                res.data.forEach(docente => {
                    docentesMap.set(docente.id, docente.nombre_completo); // Guardar docente por ID
                    const option = document.createElement('option');
                    option.value = docente.id;
                    option.textContent = docente.nombre_completo;
                    docenteSelect.appendChild(option);
                });
                $(document).ready(inicializarDocenteSelect);
            } catch (error) {
                console.error('Error cargando docentes:', error);
            }
        }

        async function obtenerNombreDocentePorId(id) {
            if (docentesMap.has(id)) {
                return docentesMap.get(id);
            }
            try {
                const res = await axios.get(`${API_BASEC}docentes/${id}/`);
                const nombre = res.data.nombre_completo;
                docentesMap.set(id, nombre); // Cachear para futuras consultas
                return nombre;
            } catch (error) {
                console.error(`Error obteniendo nombre del docente con ID ${id}:`, error);
                return 'Desconocido';
            }
        }

        async function cargarCursos() {
            try {
                const res = await axios.get(`${API_BASEC}cursos/`);
                const cursosList = document.getElementById('cursos-list');
                cursosList.innerHTML = '';

                for (const curso of res.data) {
                    const nombreDocente = await obtenerNombreDocentePorId(curso.docente_id);
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${curso.nombre}</td>
                        <td>${curso.tipo}</td>
                        <td>${nombreDocente}</td>
                        <td>${curso.estado}</td>
                        <td>
                            <div class="d-flex gap-2">
                                <!-- Botón para ver con ícono de Bootstrap -->
                                <button class="btn btn-info btn-sm custom-btn btn-ver" onclick="verCurso(${curso.id})">
                                    <i class="bi bi-eye-fill"></i> Ver
                                </button>

                                <!-- Botón para editar con ícono de Bootstrap -->
                                <button class="btn btn-warning btn-sm custom-btn btn-editar" onclick="editarCurso(${curso.id})">
                                    <i class="bi bi-pencil-fill"></i> Editar
                                </button>

                                <!-- Botón para eliminar con ícono de Bootstrap -->
                                <button class="btn btn-danger btn-sm custom-btn btn-eliminar" onclick="eliminarCurso(${curso.id})">
                                    <i class="bi bi-trash-fill"></i> Eliminar
                                </button>
                            </div>
                        </td>`;
                    cursosList.appendChild(row);
                    configurarBotonesEditarEliminar();
                }

                if (!cursosTable) {
                    cursosTable = $('#cursTable').DataTable({
                        searching: true,
                        paging: true,
                        ordering: true,
                        info: true,
                    });
                }

                // Limpia las filas existentes
                cursosTable.clear();

                (async () => {
                    for (const curso of res.data) {
                        const nombreDocente = await obtenerNombreDocentePorId(curso.docente_id);
                        cursosTable.row.add([
                            curso.nombre,
                            curso.tipo,
                            nombreDocente,
                            curso.estado,
                            `<div class="d-flex gap-2">
                                <!-- Botón para ver con ícono de Bootstrap -->
                                <button class="btn btn-info btn-sm custom-btn btn-ver" onclick="verCurso(${curso.id})">
                                    <i class="bi bi-eye-fill"></i> Ver
                                </button>
                                <button class="btn btn-warning btn-sm custom-btn btn-editar" onclick="editarCurso(${curso.id})">
                                    <i class="bi bi-pencil-fill"></i> Editar
                                </button>
                                <button class="btn btn-danger btn-sm custom-btn btn-eliminar" onclick="eliminarCurso(${curso.id})">
                                    <i class="bi bi-trash-fill"></i> Eliminar
                                </button>
                            </div>`
                        ]);
                    }
                    // Redibujar la tabla una vez que las nuevas filas se han agregado
                    cursosTable.draw();
                    configurarBotonesEditarEliminar();
                })();

            } catch (error) {
                console.error('Error cargando cursos:', error);
            }
        }

        document.getElementById('curso-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const nuevoCurso = {
                nombre: document.getElementById('nombre').value,
                descripcion: document.getElementById('descripcion').value,
                tipo: document.getElementById('tipo').value,
                tarifa: document.getElementById('tarifa').value,
                estado: document.getElementById('estado').value,
                fecha_inicio: document.getElementById('fecha_inicio').value,
                fecha_fin: document.getElementById('fecha_fin').value,
                capacidad: document.getElementById('capacidad').value,
                modulos: document.getElementById('modulos').value,
                horas: document.getElementById('horas').value,
                codigo: document.getElementById('codigo').value,
                facultad: document.getElementById('facultad').value,
                telefono: document.getElementById('telefono').value,
                docente_id: document.getElementById('docente').value, // Enviar ID, no nombre
                imagen_url: ''
            };

            try {
                if (editandoIdC) {
                    await axios.put(`${API_BASEC}cursos/${editandoIdC}/`, nuevoCurso);
                } else {
                    await axios.post(`${API_BASEC}cursos/`, nuevoCurso);
                }
                Swal.fire({
                    icon: 'success', // Icono de éxito
                    title: '¡Éxito!',
                    text: 'Curso guardado con éxito.',
                    confirmButtonText: 'Aceptar', // Botón de aceptación
                    showConfirmButton: true, // Siempre muestra el botón de confirmación
                    timer: 3000, // Cierra el mensaje automáticamente en 3 segundos
                    timerProgressBar: true // Barra de progreso mientras se cierra automáticamente
                });
                cargarCursos();
                cargarDatostabla();
                editandoIdC = null;
                document.getElementById("cursoModal").querySelector(".btn-close").click();

                // Limpiar el formulario después de guardar
                document.getElementById('curso-form').reset();

            } catch (error) {
                Swal.fire({
                    icon: 'error', // Icono de error
                    title: '¡Error!',
                    text: 'No se pudo guardar el curso. Por favor, intenta nuevamente.',
                    confirmButtonText: 'Aceptar', // Botón de aceptación
                    showConfirmButton: true, // Siempre muestra el botón de confirmación
                    timer: 5000, // Cierra el mensaje automáticamente en 5 segundos
                    timerProgressBar: true // Barra de progreso mientras se cierra automáticamente
                });
                console.error('Error guardando curso:', error);
            }
        });

        // Guardar el título original del modal al cargar la página
        const cursoModalLabel = document.getElementById('cursoModalLabel');
        const tituloOriginal = cursoModalLabel.textContent;

        async function editarCurso(id) {
            try {
                const res = await axios.get(`${API_BASEC}cursos/${id}/`);
                const data = res.data;

                document.getElementById('nombre').value = data.nombre;
                document.getElementById('descripcion').value = data.descripcion;
                document.getElementById('tipo').value = data.tipo;
                document.getElementById('tarifa').value = data.tarifa;
                document.getElementById('estado').value = data.estado;
                document.getElementById('fecha_inicio').value = data.fecha_inicio;
                document.getElementById('fecha_fin').value = data.fecha_fin;
                document.getElementById('capacidad').value = data.capacidad;
                document.getElementById('modulos').value = data.modulos;
                document.getElementById('horas').value = data.horas;
                document.getElementById('codigo').value = data.codigo;
                document.getElementById('facultad').value = data.facultad;
                document.getElementById('telefono').value = data.telefono;
                document.getElementById('docente').value = data.docente_id; // Mostrar ID en el formulario
                editandoIdC = id;

                // Cambiar el título del modal
                cursoModalLabel.textContent = 'Editar Curso';

                // Mostrar el modal
                const cursoModal = new bootstrap.Modal(document.getElementById('cursoModal'));
                cursoModal.show();

            } catch (error) {
                Swal.fire({
                    icon: 'error', // Icono de error
                    title: '¡Oops!',
                    text: 'No se pudo editar el curso. Intenta nuevamente.',
                    confirmButtonText: 'Aceptar', // Botón de aceptación
                    showConfirmButton: true, // Siempre muestra el botón de confirmación
                    timer: 5000, // Cierra el mensaje automáticamente en 5 segundos
                    timerProgressBar: true // Barra de progreso mientras se cierra automáticamente
                });
                console.error('Error cargando curso para editar:', error);
            }
        }

        async function verCurso(id) {
            try {
                const res = await axios.get(`${API_BASEC}cursos/${id}/`);
                const data = res.data;

                // Llenar los campos del formulario con los datos del curso
                document.getElementById('nombre').value = data.nombre;
                document.getElementById('descripcion').value = data.descripcion;
                document.getElementById('tipo').value = data.tipo;
                document.getElementById('tarifa').value = data.tarifa;
                document.getElementById('estado').value = data.estado;
                document.getElementById('fecha_inicio').value = data.fecha_inicio;
                document.getElementById('fecha_fin').value = data.fecha_fin;
                document.getElementById('capacidad').value = data.capacidad;
                document.getElementById('modulos').value = data.modulos;
                document.getElementById('horas').value = data.horas;
                document.getElementById('codigo').value = data.codigo;
                document.getElementById('facultad').value = data.facultad;
                document.getElementById('telefono').value = data.telefono;
                document.getElementById('docente').value = data.docente_id;

                // Cambiar el título del modal
                const modalTitle = document.getElementById('cursoModalLabel');
                const originalTitle = modalTitle.textContent;
                modalTitle.textContent = 'Ver Curso';

                // Bloquear todos los campos y botones del formulario
                const form = document.getElementById('curso-form'); // ID correcto
                const inputs = form.querySelectorAll('input, select, button, textarea');
                inputs.forEach(input => input.disabled = true);

                // Mostrar el modal
                const cursoModal = new bootstrap.Modal(document.getElementById('cursoModal'));
                cursoModal.show();

                // Restaurar el estado del formulario al cerrar el modal
                const modalElement = document.getElementById('cursoModal');
                modalElement.addEventListener('hidden.bs.modal', () => {
                    modalTitle.textContent = originalTitle; // Restaurar el título original
                    form.reset(); // Limpiar el formulario
                    inputs.forEach(input => input.disabled = false); // Habilitar campos
                }, { once: true });

            } catch (error) {
                Swal.fire({
                    icon: 'error',
                    title: '¡Oops!',
                    text: 'No se pudo cargar el curso. Intenta nuevamente.',
                    confirmButtonText: 'Aceptar',
                    timer: 5000,
                    timerProgressBar: true
                });
                console.error('Error al cargar curso para ver:', error);
            }
        }

        // Limpiar el formulario cuando se cierre el modal (al dar clic en el botón "Cerrar" o cuando se cierre manualmente)
        document.getElementById("cursoModal").addEventListener('hidden.bs.modal', function () {
            document.getElementById('curso-form').reset(); // Limpiar el formulario
        });

        // Restaurar el título original al cerrar el modal
        const cursoModalElement = document.getElementById('cursoModal');
        cursoModalElement.addEventListener('hidden.bs.modal', () => {
            cursoModalLabel.textContent = tituloOriginal;
        });

        async function eliminarCurso(id) {
            const result = await Swal.fire({
                title: '¿Estás seguro?',
                text: 'Esta acción no se puede deshacer.',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Sí, eliminar',
                cancelButtonText: 'Cancelar'
            });

            if (result.isConfirmed) {
                try {
                    await axios.delete(`${API_BASEC}cursos/${id}/`);
                    Swal.fire(
                        'Eliminado',
                        'El curso ha sido eliminado con éxito.',
                        'success'
                    );
                    cargarCursos();
                    cargarDatostabla();
                } catch (error) {
                    console.error('Error eliminando curso:', error);
                    Swal.fire(
                        'Error',
                        'Ocurrió un error al intentar eliminar el curso.',
                        'error'
                    );
                }
            }
        }

        cargarDocentes();
        cargarCursos();
    </script>


<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <script>
        const API_BASEins = 'https://finalapi.up.railway.app/api';
        let inscripTable;
        let editandoId = null;

        $('#inscripcionModal').on('shown.bs.modal', function () {
            $('#estudiante').select2({
                dropdownParent: $('#inscripcionModal'),
                placeholder: 'Seleccione o escriba un estudiante',
                allowClear: true,
                tags: true
            });
            $('#curso').select2({
                dropdownParent: $('#inscripcionModal'),
                placeholder: 'Seleccione o escriba un curso',
                allowClear: true,
                tags: true
            });
        });

        // Cargar datos en la tabla y formularios
        async function cargarDatostabla() {
            try {
                const [estudiantesRes, cursosRes, inscripcionesRes] = await Promise.all([
                    axios.get(`${API_BASEins}/estudiantes/`),
                    axios.get(`${API_BASEins}/cursos/`),
                    axios.get(`${API_BASEins}/inscripciones/`)
                ]);

                console.log('Estudiantes:', estudiantesRes.data);
                console.log('Cursos:', cursosRes.data);
                console.log('Inscripciones:', inscripcionesRes.data);
                

                const estudiantesSelect = $('#estudiante');
                estudiantesSelect.empty();
                estudiantesRes.data.forEach(estudiante => {
                    estudiantesSelect.append(new Option(
                        `${estudiante.nombre_completo} - ${estudiante.matricula}`,
                        estudiante.id,
                        false,
                        false
                    ));
                });

                const cursosSelect = $('#curso');
                cursosSelect.empty();
                cursosRes.data.forEach(curso => {
                    cursosSelect.append(new Option(
                        `${curso.nombre} - ${curso.codigo}`,
                        curso.id,
                        false,
                        false
                    ));
                });

                const estudiantes = Object.fromEntries(estudiantesRes.data.map(e => [e.id, e.nombre_completo]));
                const cursos = Object.fromEntries(cursosRes.data.map(c => [c.id, c.nombre]));

                const inscripcionesList = document.getElementById('inscripciones-list');
                inscripcionesList.innerHTML = '';

                inscripcionesRes.data.forEach(inscripcion => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${estudiantes[inscripcion.estudiante] || 'N/A'}</td>
                        <td>${cursos[inscripcion.curso] || 'N/A'}</td>
                        <td>${inscripcion.estado}</td>
                        <td>
                            <div class="d-flex gap-2">
                                <button class="btn btn-info btn-sm custom-btn btn-ver" onclick="verInscripcion(${inscripcion.id})">
                                    <i class="bi bi-eye-fill"></i> Ver
                                </button>
                                <button class="btn btn-warning btn-sm custom-btn btn-editar" onclick="editarInscripcion(${inscripcion.id})">
                                    <i class="bi bi-pencil-fill"></i> Editar
                                </button>
                                <button class="btn btn-danger btn-sm custom-btn btn-eliminar" onclick="eliminarInscripcion(${inscripcion.id})">
                                    <i class="bi bi-trash-fill"></i> Eliminar
                                </button>
                            </div>
                        </td>
                    `;
                    inscripcionesList.appendChild(row);
                    configurarBotonesEditarEliminar();
                });

                if (!$.fn.dataTable.isDataTable('#inscripTable')) {
                    inscripTable = $('#inscripTable').DataTable({
                        "searching": true,
                        "paging": true,
                        "ordering": true,
                        "info": true
                    });
                } else {
                    inscripTable.clear();
                    inscripcionesRes.data.forEach(inscripcion => {
                        inscripTable.row.add([
                            estudiantes[inscripcion.estudiante] || 'N/A',
                            cursos[inscripcion.curso] || 'N/A',
                            inscripcion.estado,
                            `
                            <div class="d-flex gap-2">
                                <button class="btn btn-info btn-sm custom-btn btn-ver" onclick="verInscripcion(${inscripcion.id})">
                                    <i class="bi bi-eye-fill"></i> Ver
                                </button>
                                <button class="btn btn-warning btn-sm custom-btn btn-editar" onclick="editarInscripcion(${inscripcion.id})">
                                    <i class="bi bi-pencil-fill"></i> Editar
                                </button>
                                <button class="btn btn-danger btn-sm custom-btn btn-eliminar" onclick="eliminarInscripcion(${inscripcion.id})">
                                    <i class="bi bi-trash-fill"></i> Eliminar
                                </button>
                            </div>`
                        ]);
                    });
                    inscripTable.draw();
                    configurarBotonesEditarEliminar();
                }
            } catch (error) {
                console.error('Error cargando los datos:', error);
            }
        }

        // Manejar envío del formulario de inscripción
        document.getElementById('inscripcion-form').addEventListener('submit', async (e) => {
            e.preventDefault();

            const estudianteId = $('#estudiante').val();
            const cursoId = $('#curso').val();
            const nuevaInscripcion = {
                estudiante: estudianteId,
                curso: cursoId,
                estado: document.getElementById('estadoins').value
            };

            try {
                // Verificar si el estudiante ya está inscrito en el mismo curso
                const inscripcionesRes = await axios.get(`${API_BASEins}/inscripciones/`);
                const yaInscrito = inscripcionesRes.data.some(inscripcion =>
                    inscripcion.estudiante == estudianteId &&
                    inscripcion.curso == cursoId &&
                    (editandoId ? inscripcion.id !== editandoId : true) // Si estamos editando, excluimos la inscripción actual
                );

                if (yaInscrito) {
                    Swal.fire({
                        icon: 'warning', // Icono de advertencia
                        title: 'Aviso',
                        text: 'El estudiante ya está inscrito en este curso.',
                        confirmButtonText: 'Aceptar', // Texto del botón para aceptar
                        showConfirmButton: true, // Mostrar el botón de confirmación
                        timer: 4000, // Cierre automático en 4 segundos
                        timerProgressBar: true // Barra de progreso mientras se cierra
                    });
                    return;
                }

                if (editandoId) {
                    console.log('Editando inscripción con ID:', editandoId);
                    await axios.put(`${API_BASEins}/inscripciones/${editandoId}/`, nuevaInscripcion);
                } else {
                    console.log('Creando nueva inscripción');
                    await axios.post(`${API_BASEins}/inscripciones/`, nuevaInscripcion);
                }

                cargarDatostabla();
                e.target.reset();
                editandoId = null;
                Swal.fire({
                    icon: 'success', // Icono de éxito
                    title: '¡Inscripción exitosa!',
                    text: 'El estudiante ha sido inscrito correctamente en el curso.',
                    confirmButtonText: 'Aceptar', // Texto del botón de confirmación
                    showConfirmButton: true, // Mostrar el botón de confirmación
                    timer: 4000, // Cierre automático después de 4 segundos
                    timerProgressBar: true // Barra de progreso mientras se cierra
                });
                document.getElementById('inscripcionModalLabel').textContent = 'Nueva Inscripción';
                document.getElementById("inscripcionModal").querySelector(".btn-close").click();

            } catch (error) {
                Swal.fire({
                    icon: 'error', // Icono de error
                    title: 'Oops...',
                    text: 'Hubo un problema al intentar realizar la inscripción. Por favor, inténtalo de nuevo.',
                    confirmButtonText: 'Aceptar', // Texto del botón de confirmación
                    showConfirmButton: true, // Mostrar el botón de confirmación
                    timer: 5000, // Cierre automático después de 5 segundos
                    timerProgressBar: true // Barra de progreso mientras se cierra
                });
                console.error('Error guardando inscripción:', error);
            }
        });

        // Abrir modal para nueva inscripción
        function abrirModalInscripciones() {
            editandoId = null;
            document.getElementById('inscripcionModalLabel').textContent = 'Nueva Inscripción';
            document.getElementById('inscripcion-form').reset();
            
            // Deshabilitar el campo de estadoins al abrir el modal
            document.getElementById('estadoins').setAttribute('disabled', true); // Ahora lo bloqueamos al abrir

            // Si lo quieres desbloquear después de que el modal se haya cerrado o en otro contexto, hazlo en otro lugar.
        }


        // Editar inscripción
        async function editarInscripcion(id) {
            try {
                console.log('Editando inscripción con ID:', id);

                // Obtenemos los datos de la inscripción para la edición
                const res = await axios.get(`${API_BASEins}/inscripciones/${id}/`);
                const estudianteId = res.data.estudiante;
                const cursoId = res.data.curso;

                // Obtener todas las inscripciones para validar duplicados
                const inscripcionesRes = await axios.get(`${API_BASEins}/inscripciones/`);

                // Verificar si ya existe otra inscripción para el mismo estudiante y curso, pero que no sea la que estamos editando
                const yaInscrito = inscripcionesRes.data.some(inscripcion =>
                    inscripcion.estudiante == estudianteId &&
                    inscripcion.curso == cursoId &&
                    inscripcion.id !== id // Excluimos la inscripción que estamos editando
                );

                if (yaInscrito) {
                    Swal.fire({
                        icon: 'warning', // Icono de advertencia
                        title: 'Aviso',
                        text: 'El estudiante ya está inscrito en este curso.',
                        confirmButtonText: 'Aceptar', // Texto del botón para aceptar
                        showConfirmButton: true, // Mostrar el botón de confirmación
                        timer: 4000, // Cierre automático en 4 segundos
                        timerProgressBar: true // Barra de progreso mientras se cierra
                    });

                    return;
                }

                // Si no existe una inscripción duplicada, cargar los datos en el formulario
                document.getElementById('estudiante').value = estudianteId;
                document.getElementById('curso').value = cursoId;
                document.getElementById('estadoins').value = res.data.estado;
                
                editandoId = id;

                document.getElementById('inscripcionModalLabel').textContent = 'Editar Inscripción';

                // Abrir el modal
                const modal = new bootstrap.Modal(document.getElementById('inscripcionModal'));
                modal.show();
            } catch (error) {

                Swal.fire({
                    icon: 'error', // Icono de error
                    title: '¡Error!',
                    text: 'Hubo un problema al intentar editar la inscripción. Por favor, intenta nuevamente.',
                    confirmButtonText: 'Aceptar', // Texto del botón de confirmación
                    showConfirmButton: true, // Mostrar el botón de confirmación
                    timer: 5000, // Cierre automático después de 5 segundos
                    timerProgressBar: true // Barra de progreso mientras se cierra
                });

                console.error('Error cargando inscripción para editar:', error);
            }
        }

        // Función para ver detalles de inscripción
        async function verInscripcion(id) {
            try {
                console.log('Viendo inscripción con ID:', id);

                // Obtener los datos de la inscripción
                const res = await axios.get(`${API_BASEins}/inscripciones/${id}/`);
                const estudianteId = res.data.estudiante;
                const cursoId = res.data.curso;

                // Cargar los datos en el formulario
                document.getElementById('estudiante').value = estudianteId;
                document.getElementById('curso').value = cursoId;
                document.getElementById('estadoins').value = res.data.estado;

                // Bloquear todos los campos del formulario y el botón
                document.getElementById('estudiante').setAttribute('disabled', true);
                document.getElementById('curso').setAttribute('disabled', true);
                document.querySelector('#inscripcion-form button[type="submit"]').setAttribute('disabled', true);

                // Cambiar el título del modal
                document.getElementById('inscripcionModalLabel').textContent = 'Ver Inscripción';

                // Abrir el modal
                const modal = new bootstrap.Modal(document.getElementById('inscripcionModal'));
                modal.show();

                // Restaurar todo al cerrar el modal
                document.getElementById('inscripcionModal').addEventListener('hidden.bs.modal', () => {
                    document.getElementById('estudiante').removeAttribute('disabled');
                    document.getElementById('curso').removeAttribute('disabled');
                    document.getElementById('inscripcionModalLabel').textContent = 'Nueva Inscripción';
                }, { once: true });

            } catch (error) {
                Swal.fire({
                    icon: 'error',
                    title: '¡Error!',
                    text: 'Hubo un problema al intentar ver la inscripción. Por favor, intenta nuevamente.',
                    confirmButtonText: 'Aceptar',
                    showConfirmButton: true,
                    timer: 5000,
                    timerProgressBar: true
                });

                console.error('Error viendo inscripción:', error);
            }
        }


        async function eliminarInscripcion(id) {
            const result = await Swal.fire({
                title: '¿Estás seguro?',
                text: 'Esta acción eliminará la inscripción de forma permanente.',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Sí, eliminar',
                cancelButtonText: 'Cancelar'
            });

            if (result.isConfirmed) {
                try {
                    console.log('Eliminando inscripción con ID:', id);
                    await axios.delete(`${API_BASEins}/inscripciones/${id}/`);
                    Swal.fire(
                        'Eliminada',
                        'La inscripción ha sido eliminada con éxito.',
                        'success'
                    );
                    cargarDatostabla();
                } catch (error) {
                    console.error('Error eliminando inscripción:', error);
                    Swal.fire(
                        'Error',
                        'Ocurrió un error al intentar eliminar la inscripción.',
                        'error'
                    );
                }
            }
        }

        // Cargar los datos al iniciar
        cargarDatostabla();

    </script>


<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->


    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            try {
                // Inicializar Select2 para los campos de inscripción
                $("#inscripcion_agregar").select2({
                    placeholder: "Selecciona una inscripción",
                    allowClear: true,
                    dropdownParent: $("#modalAgregarPago"),
                });

                $("#inscripcion_editar").select2({
                    placeholder: "Selecciona una inscripción",
                    allowClear: true,
                    dropdownParent: $("#modalEditarPago"),
                });

                // Cargar inscripciones antes de inicializar cualquier interacción
                await cargarInscripciones();

                // Cargar pagos después de configurar las inscripciones
                await cargarPagos();
            } catch (error) {
                console.error("Error durante la inicialización:", error);
            }
        });

        // Función para convertir y formatear un monto
        function convertirYFormatearMonto(monto) {
            // Eliminar "RD$", puntos y comas, y convertir a número flotante
            let montoNumerico = parseFloat(monto.replace("RD$", "").replace(/\./g, "").replace(",", "."));

            if (isNaN(montoNumerico)) {
                throw new Error("El monto proporcionado no es válido.");
            }

            // Formatear el número al estilo "RD$ 1,234.56"
            return `RD$ ${montoNumerico.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,')}`;
        }

        const API_PAGOS = "https://finalapi.up.railway.app/api/historial-pagos/";
        const API_INSCRIPCIONES = "https://finalapi.up.railway.app/inscripciones/";
        const API_PAGOS_SUMA_HISTORIAL = "https://finalapi.up.railway.app/api/pagos-suma-historial/";
        let inscripciones = {};

        // Cargar inscripciones y llenar los select en los formularios
        async function cargarInscripciones() {
            try {
                const response = await fetch(API_INSCRIPCIONES);
                const data = await response.json();

                // Crear el mapa de inscripciones
                inscripciones = data.reduce((acc, inscripcion) => {
                    acc[inscripcion.id] = inscripcion;
                    return acc;
                }, {});

                // Llenar los select dinámicamente
                llenarSelectInscripciones("#inscripcion_agregar");
                llenarSelectInscripciones("#inscripcion_editar");
            } catch (error) {
                console.error("Error cargando inscripciones:", error);
            }
        }

        // Llenar un select con las inscripciones cargadas
        function llenarSelectInscripciones(selectId) {
            const select = $(selectId);
            select.empty(); // Limpiar las opciones existentes

            Object.values(inscripciones).forEach(inscripcion => {
                const option = new Option(
                    `${inscripcion.nombre_estudiante} - ${inscripcion.nombre_curso}`, // Texto visible
                    inscripcion.id, // Valor
                    false, // Seleccionado por defecto
                    false // Selección inicial
                );
                select.append(option);
            });

            select.trigger("change"); // Actualizar visualización de Select2
        }

        // Función para cargar pagos en la tabla principal
        async function cargarPagos() {
            try {
                const response = await fetch(API_PAGOS);
                const pagos = await response.json();
                const tableBody = document.getElementById("pagos-table-body");
                tableBody.innerHTML = "";

                let registrosMuestra = {}; // Para evitar duplicados

                // Agregar las filas de pago a la tabla
                for (const pago of pagos) {
                    const inscripcion = inscripciones[pago.inscripcion];
                    const estudiante = inscripcion ? inscripcion.nombre_estudiante : "Desconocido";
                    const curso = inscripcion ? inscripcion.nombre_curso : "Desconocido";

                    const claveRegistro = `${pago.inscripcion}`;
                    if (registrosMuestra[claveRegistro]) {
                        continue; // Si ya existe, omitir este pago
                    }
                    registrosMuestra[claveRegistro] = true;

                    const row = `
                        <tr data-inscripcion-id="${pago.inscripcion}">
                            <td>${pago.metodo_pago}</td>
                            <td>${estudiante} - ${curso}</td>
                            <td>...</td> <!-- Se actualizará con la suma total -->
                            <td>${pago.estado_pago}</td>
                            <td>${formatearFecha(pago.fecha_vencimiento)}</td>
                            <td>
                                <button class="btn btn-sm btn-info" onclick="mostrarHistorial(${pago.inscripcion})">
                                    <i class="bi bi-clock-history"></i> Historial
                                </button>

                            </td>
                        </tr>
                    `;
                    cargarSumaYHistorial(pago.inscripcion);
                    tableBody.insertAdjacentHTML("beforeend", row);
                }

                // Asegúrate de que el DataTable se dibuje correctamente
                if (!$.fn.dataTable.isDataTable('#pagoTable')) {
                    // Si el DataTable no está inicializado, lo inicializamos
                    $('#pagoTable').DataTable({
                        searching: true,
                        paging: true,
                        ordering: true,
                        info: true,
                    });
                } else {
                    // Si ya está inicializado, simplemente redibujamos la tabla
                    $('#pagoTable').DataTable().clear(); // Limpiar la tabla existente
                    $('#pagoTable').DataTable().rows.add(tableBody.rows); // Agregar las filas nuevamente
                    $('#pagoTable').DataTable().draw(); // Redibujar la tabla
                }

            } catch (error) {
                console.error("Error cargando pagos:", error);
            }
        }


        // Función para alternar entre la tabla de pagos y la tabla de historial
        function alternarTablas(mostrarHistorial = false) {
            const tablaPagos = document.getElementById("tabla-pagos-container");
            const tablaHistorial = document.getElementById("tabla-historial-container");

            // Mostrar o esconder la tabla de pagos y historial
            if (mostrarHistorial) {
                tablaPagos.style.display = "none";
                tablaHistorial.style.display = "block";
            } else {
                tablaHistorial.style.display = "none";
                tablaPagos.style.display = "block";
            }

            // Limpiar la tabla de historial si estamos volviendo a la tabla de pagos
            if (!mostrarHistorial) {
                const historialTableBody = document.getElementById("historial-table-body");
                historialTableBody.innerHTML = "";  // Limpiar la tabla de historial
            }
        }

        // Modificar el botón "Ver Historial" en la tabla principal
        function mostrarHistorial(inscripcionId) {
            // Cargar los datos del historial si es necesario
            cargarSumaYHistorial(inscripcionId).then(() => {
                // Cambiar a la vista de historial después de cargar los datos
                alternarTablas(true);
            }).catch(error => {
                console.error("Error al cargar el historial:", error);
            });
        }

        // Función auxiliar para formatear fechas
        function formatearFecha(fecha) {
            return new Date(fecha).toLocaleDateString('es-DO', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
            });
        }

        // Función para inicializar o reinicializar el DataTable
        function inicializarDataTable(selector) {
            const tabla = $(selector);

            // Verificar si el DataTable ya está inicializado
            if ($.fn.DataTable.isDataTable(selector)) {
                tabla.DataTable().clear(); // Limpia los datos actuales
                tabla.DataTable().destroy(); // Destruir la instancia existente
            }

            // Inicializar el DataTable con las opciones deseadas
            tabla.DataTable({
                searching: true,
                paging: true,
                ordering: true,
                info: true,
            });
        }

        // Función para cargar la suma y el historial
        async function cargarSumaYHistorial(inscripcionId) {
            try {
                // Hacer la solicitud a la API de pagos-suma-historial
                const response = await fetch(`${API_PAGOS_SUMA_HISTORIAL}${inscripcionId}/suma-historial/`);
                const data = await response.json();

                // Verificar si la respuesta contiene datos válidos
                if (data && data.historial) {
                    const sumaTotal = data.suma_total; // Suma total
                    const historial = data.historial; // Historial de pagos

                    // Actualizar el atributo data-inscripcion-id en el contenedor
                    const historialContainer = document.getElementById("tabla-historial-container");
                    historialContainer.dataset.inscripcionId = inscripcionId;

                    // Actualizar la suma total en la sección del historial
                    const sumaTotalDisplay = document.getElementById("suma-total-display");
                    sumaTotalDisplay.textContent = `Total: ${convertirYFormatearMonto(sumaTotal)}`;

                    // Limpiar la tabla del historial antes de llenarla con nuevos datos
                    const historialTableBody = document.getElementById("historial-table-body");
                    if (!historialTableBody) {
                        console.error("No se encontró el cuerpo de la tabla de historial.");
                        return;
                    }
                    historialTableBody.innerHTML = "";

                    // Insertar los datos del historial en la tabla
                    historial.forEach(h => {
                        const row = `
                            <tr>
                                <td>${formatearFecha(h.fecha_pago)}</td>
                                <td>${h.metodo_pago}</td>
                                <td>${convertirYFormatearMonto(h.monto)}</td>
                                <td>${h.estado_pago}</td>
                                <td>${formatearFecha(h.fecha_vencimiento)}</td>
                                <td>
                                    <button class="btn btn-sm btn-warning btn-editar" onclick="abrirEditar(${h.id})">
                                        <i class="bi bi-pencil-fill"></i> Editar
                                    </button>
                                    <button class="btn btn-sm btn-danger btn-eliminar" onclick="eliminarPago(${h.id})">
                                        <i class="bi bi-trash-fill"></i> Eliminar
                                    </button>
                                </td>
                            </tr>
                        `;
                        historialTableBody.insertAdjacentHTML("beforeend", row);
                        configurarBotonesEditarEliminar();
                    });

                    // Actualizar la columna "Monto" en la tabla de pagos
                    const pagoRow = document.querySelector(`tr[data-inscripcion-id="${inscripcionId}"] td:nth-child(3)`);
                    if (pagoRow) {
                        pagoRow.textContent = convertirYFormatearMonto(sumaTotal);
                    }

                } else {
                    console.log("No se encontró historial para esta inscripción.");
                }

            } catch (error) {
                console.error("Error obteniendo la suma y el historial:", error);
            }
        }



        // Abrir modal para agregar un pago
        function abrirAgregar() {
            const modalAgregarPago = new bootstrap.Modal(document.getElementById("modalAgregarPago"));
            document.getElementById("formAgregarPago").reset();
            cargarInscripciones().then(() => {
                $("#inscripcion_agregar").val(null).trigger("change"); // Limpiar selección previa
                modalAgregarPago.show();
            });
        }

        // Abrir modal para editar un pago
        async function abrirEditar(id) {
            try {
                const response = await fetch(`${API_PAGOS}${id}/`);
                const pago = await response.json();

                await cargarInscripciones(); // Asegurar que las inscripciones estén actualizadas

                document.getElementById("pago_id_editar").value = id;
                document.getElementById("metodo_pago_editar").value = pago.metodo_pago;
                document.getElementById("monto_editar").value = pago.monto;
                document.getElementById("estado_pago_editar").value = pago.estado_pago;
                document.getElementById("fecha_vencimiento_editar").value = pago.fecha_vencimiento;
                $("#inscripcion_editar").val(pago.inscripcion).trigger("change"); // Seleccionar inscripción

                new bootstrap.Modal(document.getElementById("modalEditarPago")).show();
            } catch (error) {
                console.error("Error cargando pago para editar:", error);
            }
        }

        // Guardar nuevo pago
        async function guardarNuevoPago() {
            const metodoPago = document.getElementById("metodo_pago_agregar").value;
            const monto = document.getElementById("monto_agregar").value;
            const estadoPago = document.getElementById("estado_pago_agregar").value;
            const fechaVencimiento = document.getElementById("fecha_vencimiento_agregar").value;
            const inscripcionId = document.getElementById("inscripcion_agregar").value;

            const nuevoPago = {
                metodo_pago: metodoPago,
                monto: monto,
                estado_pago: estadoPago,
                fecha_vencimiento: fechaVencimiento,
                inscripcion: parseInt(inscripcionId)
            };

            try {
                const response = await fetch(API_PAGOS, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(nuevoPago)
                });

                if (response.ok) {
                    Swal.fire({
                        icon: 'success', // Icono de éxito
                        title: '¡Éxito!',
                        text: 'Pago agregado exitosamente. Se le enviara una notificacion al correo del estudiante.',
                        confirmButtonText: 'Aceptar', // Texto del botón de confirmación
                        showConfirmButton: true, // Mostrar el botón de confirmación
                        timer: 3000, // Cierre automático después de 3 segundos
                        timerProgressBar: true // Barra de progreso mientras se cierra
                    });
                    bootstrap.Modal.getInstance(document.getElementById("modalAgregarPago")).hide();
                    await cargarDatostabla();
                    await cargarPagos();                    
                } else {
                    const errorData = await response.json();
                    Swal.fire({
                        icon: 'error', // Icono de error
                        title: '¡Error!',
                        text: 'Error al agregar el pago. Revisa los datos ingresados.',
                        confirmButtonText: 'Aceptar', // Texto del botón de confirmación
                        showConfirmButton: true, // Mostrar el botón de confirmación
                        timer: 4000, // Cierre automático después de 4 segundos
                        timerProgressBar: true // Barra de progreso mientras se cierra
                    });
                    console.error("Error al agregar pago:", errorData);
                }
            
            } catch (error) {
                console.error("Error en la solicitud:", error);
                Swal.fire({
                    icon: 'error', // Icono de error
                    title: '¡Error!',
                    text: 'Error al enviar el pago.',
                    confirmButtonText: 'Aceptar', // Texto del botón de confirmación
                    showConfirmButton: true, // Mostrar el botón de confirmación
                    timer: 4000, // Cierre automático después de 4 segundos
                    timerProgressBar: true // Barra de progreso mientras se cierra
                });
            }
        }

        // Guardar cambios al editar un pago
        async function guardarPagoEditado() {
            // Obtener los valores del formulario de edición
            const id = document.getElementById("pago_id_editar").value;
            const metodoPago = document.getElementById("metodo_pago_editar").value;
            const monto = document.getElementById("monto_editar").value;
            const estadoPago = document.getElementById("estado_pago_editar").value;
            const fechaVencimiento = document.getElementById("fecha_vencimiento_editar").value;
            const inscripcion = document.getElementById("inscripcion_editar").value;

            // Crear el objeto con los datos editados
            const pagoEditado = {
                metodo_pago: metodoPago,
                monto: parseFloat(monto), // Asegurarnos de que el monto sea un número
                estado_pago: estadoPago,
                fecha_vencimiento: fechaVencimiento,
                inscripcion: parseInt(inscripcion),
            };

            try {
                // Realizar la solicitud para actualizar el pago
                const response = await fetch(`${API_PAGOS}${id}/`, {
                    method: "PUT", // Usamos PUT para actualizar
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(pagoEditado)
                });

                if (response.ok) {
                    Swal.fire({
                        icon: 'success', // Icono de éxito
                        title: '¡Éxito!',
                        text: 'Pago editado exitosamente.',
                        confirmButtonText: 'Aceptar', // Texto del botón de confirmación
                        showConfirmButton: true, // Mostrar el botón de confirmación
                        timer: 4000, // Cierre automático después de 4 segundos
                        timerProgressBar: true // Barra de progreso mientras se cierra
                    });

                    // Ocultar el modal de edición
                    bootstrap.Modal.getInstance(document.getElementById("modalEditarPago")).hide();
                    
                    // Recargar la tabla del historial y el monto actualizado
                    const historialContainer = document.getElementById("tabla-historial-container");
                    const inscripcionId = historialContainer.dataset.inscripcionId;

                    if (inscripcionId) {
                        await cargarSumaYHistorial(inscripcionId);
                    } else {
                        console.error("No se encontró el ID de inscripción para actualizar el historial.");
                    }
                } else {
                    const errorData = await response.json();
                    Swal.fire({
                        icon: 'error', // Icono de error
                        title: '¡Error!',
                        text: 'Error al editar el pago. Revisa los datos ingresados.',
                        confirmButtonText: 'Aceptar', // Texto del botón de confirmación
                        showConfirmButton: true, // Mostrar el botón de confirmación
                        timer: 5000, // Cierre automático después de 5 segundos
                        timerProgressBar: true // Barra de progreso mientras se cierra
                    });
                    console.error("Error al editar pago:", errorData);
                }
            } catch (error) {
                console.error("Error en la solicitud:", error);
                Swal.fire({
                    icon: 'error', // Icono de error
                    title: '¡Error!',
                    text: 'Error al editar el pago. Revisa la consola para más detalles.',
                    confirmButtonText: 'Aceptar', // Texto del botón de confirmación
                    showConfirmButton: true, // Mostrar el botón de confirmación
                    timer: 5000, // Cierre automático después de 5 segundos
                    timerProgressBar: true // Barra de progreso mientras se cierra
                });
            }
        }


        async function eliminarPago(id) {
            const result = await Swal.fire({
                title: '¿Estás seguro?',
                text: 'Esta acción eliminará el pago de forma permanente.',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Sí, eliminar',
                cancelButtonText: 'Cancelar'
            });

            if (result.isConfirmed) {
                try {
                    const response = await fetch(`${API_PAGOS}${id}/`, {
                        method: "DELETE",
                    });

                    if (response.ok) {
                        Swal.fire(
                            'Eliminado',
                            'El pago ha sido eliminado con éxito.',
                            'success'
                        );

                        // Obtener inscripcionId desde el contenedor
                        const historialContainer = document.getElementById("tabla-historial-container");
                        const inscripcionId = historialContainer.dataset.inscripcionId;

                        // Recargar solo el historial y el monto
                        if (inscripcionId) {
                            await cargarSumaYHistorial(inscripcionId);
                        } else {
                            console.error("No se encontró el ID de inscripción.");
                        }
                    } else {
                        console.error("Error eliminando pago:", response.statusText);
                        Swal.fire(
                            'Error',
                            'No se pudo eliminar el pago. Por favor, inténtelo nuevamente.',
                            'error'
                        );
                    }
                } catch (error) {
                    console.error("Error eliminando pago:", error);
                    Swal.fire(
                        'Error',
                        'Ocurrió un error al intentar eliminar el pago.',
                        'error'
                    );
                }
            }
        }

    </script>


<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <!-- Incluir Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>

    <script>

        async function exportarPDF() {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            const reportSection = document.getElementById('report-section');
            const buttonContainer = document.querySelector('.button-container');

            if (!reportSection || !buttonContainer) {
                console.error('Elemento(s) no encontrado(s) en el DOM.');
                return;
            }

            try {
                // Ocultar botones antes de la captura
                buttonContainer.style.display = 'none';

                // Asegurar que los estilos actualizados se apliquen
                await new Promise((resolve) => setTimeout(resolve, 100));

                // Generar captura con html2canvas
                const canvas = await html2canvas(reportSection, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                });

                // Convertir la captura a imagen y añadirla al PDF
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 190; // Ancho de la imagen en mm
                const imgHeight = (canvas.height * imgWidth) / canvas.width;

                pdf.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);

                // Guardar archivo PDF en el dispositivo
                pdf.save('informe_cursos.pdf');
            } catch (error) {
                console.error('Error al exportar a PDF:', error);
                Swal.fire({
                    icon: 'error',
                    title: '¡Error!',
                    text: 'Hubo un problema al generar el PDF. Por favor, inténtalo de nuevo.',
                    confirmButtonText: 'Aceptar',
                    showConfirmButton: true,
                    timer: 5000,  // Se puede ajustar el tiempo de duración
                    timerProgressBar: true  // Activa la barra de progreso en el temporizador
                });
            } finally {
                // Mostrar botones nuevamente después del proceso
                buttonContainer.style.display = 'flex';
            }
        }

        // Escuchar el mensaje para ejecutar la exportación
        window.addEventListener('message', (event) => {
            if (event.data === 'exportarPDF') {
                exportarPDF();
            }
        });

        const API_BASE = 'https://finalapi.up.railway.app/';

        async function fetchCursos() {
            const response = await fetch(`${API_BASE}api/cursos/`);
            if (!response.ok) throw new Error("Error al obtener los cursos");
            return response.json();
        }

        async function fetchInscripciones() {
            const response = await fetch(`${API_BASE}api/inscripciones/`);
            if (!response.ok) throw new Error("Error al obtener las inscripciones");
            return response.json();
        }

        async function fetchPagos() {
            const response = await fetch(`${API_BASE}api/historial-pagos/`);
            if (!response.ok) throw new Error("Error al obtener los pagos");
            return response.json();
        }

        async function generarTabla() {
            try {
                const cursos = await fetchCursos();
                const inscripciones = await fetchInscripciones();
                const pagos = await fetchPagos();

                let totalRecaudado = 0;

                function convertirMonto(monto) {
                    try {
                        const montoLimpiado = monto.replace("RD$", "").replace(/\./g, "").replace(",", ".");
                        return parseFloat(montoLimpiado);
                    } catch (error) {
                        console.error("Error al convertir monto:", monto, error);
                        return 0; 
                    }
                }

                const cursoData = cursos.map(curso => {
                    const inscripcionesCurso = inscripciones.filter(inscripcion => inscripcion.curso === curso.id);
                    const estudiantesInscritos = inscripcionesCurso.length;
                    const idsInscripciones = inscripcionesCurso.map(inscripcion => inscripcion.id);

                    const dineroRecaudado = pagos
                        .filter(pago => idsInscripciones.includes(pago.inscripcion))
                        .reduce((total, pago) => total + convertirMonto(pago.monto), 0);

                    totalRecaudado += dineroRecaudado;

                    return {
                        nombre: curso.nombre,
                        estudiantesInscritos,
                        dineroRecaudado: dineroRecaudado.toFixed(2),
                    };
                });

                // Inicializar la tabla
                const tableBody = document.getElementById("curso-table-body");
                tableBody.innerHTML = cursoData
                    .map(curso => `
                        <tr>
                            <td>${curso.nombre}</td>
                            <td>${curso.estudiantesInscritos}</td>
                            <td>RD$${formatMoney(curso.dineroRecaudado)}</td>
                        </tr>
                    `)
                    .join("");

                // Actualizar total recaudado
                document.getElementById("total-recaudado").textContent = `RD$${formatMoney(totalRecaudado.toFixed(2))}`;

                // Convertir la tabla a DataTable
                const tablaCursos = $("#curso-data-table").DataTable();
                tablaCursos.clear(); // Vaciar datos existentes

                cursoData.forEach(curso => {
                    tablaCursos.row.add([
                        curso.nombre,
                        curso.estudiantesInscritos,
                        `RD$${formatMoney(curso.dineroRecaudado)}`,
                    ]).draw();
                });

                // Llamar a la función para generar los gráficos
                generarGraficos(cursoData);

            } catch (error) {
                console.error("Error al generar la tabla:", error);
            }
        }


        // Función para formatear los números con coma
        function formatMoney(amount) {
            return amount.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        // Función para formatear el dinero con RD$
        function formatCurrency(amount) {
            return amount.toLocaleString('es-DO', {
                style: 'currency',
                currency: 'DOP',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }

        // Variables globales para almacenar las instancias de los gráficos
        let barChart = null;
        let pieChart = null;

        // Función para destruir los gráficos existentes antes de crear nuevos
        function destruirGraficos() {
            if (barChart) {
                barChart.destroy();
                barChart = null; // Asegurarse de que la instancia de barChart se reinicie
            }
            if (pieChart) {
                pieChart.destroy();
                pieChart = null; // Asegurarse de que la instancia de pieChart se reinicie
            }
        }

        // Función para generar los gráficos
        function generarGraficos(cursoData) {
            // Datos para los gráficos
            const cursos = cursoData.map(curso => curso.nombre);
            const estudiantesInscritos = cursoData.map(curso => curso.estudiantesInscritos);
            const dineroRecaudado = cursoData.map(curso => parseFloat(curso.dineroRecaudado.replace('RD$', '').replace(',', '')));

            // Destruir gráficos existentes antes de crear nuevos
            destruirGraficos();

            // Gráfico de barras
            const barCanvas = document.getElementById('barChart');
            if (barCanvas) {
                const barCtx = barCanvas.getContext('2d');
                barChart = new Chart(barCtx, {
                    type: 'bar',
                    data: {
                        labels: cursos,
                        datasets: [{
                            label: 'Estudiantes Inscritos',
                            data: estudiantesInscritos,
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            // Gráfico de pastel
            const pieCanvas = document.getElementById('pieChart');
            if (pieCanvas) {
                const pieCtx = pieCanvas.getContext('2d');
                pieChart = new Chart(pieCtx, {
                    type: 'pie',
                    data: {
                        labels: cursos,
                        datasets: [{
                            label: 'Dinero Recaudado',
                            data: dineroRecaudado,
                            backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#FF9F40'],
                        }]
                    }
                });
            }
        }

        async function fetchAndRenderData() {
            try {
                const response = await fetch('https://finalapi.up.railway.app/estadisticas/');
                if (!response.ok) throw new Error('Error al obtener los datos de la API');

                const data = await response.json();
                console.log('Datos obtenidos:', data);

                // Tabla: Informe de Cursos por Año
                let tableData = [];
                let totalGeneral = 0;

                // Procesar los datos para DataTable
                data.cursos_por_anio.forEach((cursoAnio) => {
                    const recaudacion = data.recaudacion_por_anio.find(
                        (r) => r.anio_pago === cursoAnio.anio_inicio
                    );
                    const totalRecaudado = parseFloat(recaudacion?.total_recaudado || 0);
                    totalGeneral += totalRecaudado;

                    tableData.push([
                        cursoAnio.anio_inicio, // Año
                        cursoAnio.cantidad, // Cantidad de Cursos
                        formatCurrency(totalRecaudado), // Total Recaudado
                    ]);
                });

                // Mostrar el total general
                document.getElementById('total-general').textContent = formatCurrency(totalGeneral);

                const table = $('#tabla-cursos-por-ano').DataTable({
                    responsive: true,
                    data: tableData,
                    destroy: true,
                    columns: [
                        { title: 'Año' },
                        { title: 'Cantidad de Cursos' },
                        { title: 'Total Recaudado' },
                    ],
                    paging: true,
                    searching: true,
                    ordering: true,
                    lengthMenu: [5, 10, 25, 50, 100],
                    pageLength: 5,
                });


                // Gráfico: Histograma
                const ctxHistogram = document.getElementById('histogramChart').getContext('2d');
                if (window.histogramChartInstance) {
                    window.histogramChartInstance.destroy();
                }
                window.histogramChartInstance = new Chart(ctxHistogram, {
                    type: 'bar',
                    data: {
                        labels: data.cursos_por_anio.map((item) => item.anio_inicio),
                        datasets: [{
                            label: 'Cantidad de Cursos',
                            data: data.cursos_por_anio.map((item) => item.cantidad),
                            backgroundColor: 'rgba(54, 162, 235, 0.6)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1,
                        }],
                    },
                    options: {
                        responsive: true,
                        scales: {
                            x: {
                                title: { display: true, text: 'Año de Inicio' },
                            },
                            y: {
                                title: { display: true, text: 'Cantidad de Cursos' },
                                beginAtZero: true,
                            },
                        },
                    },
                });
            } catch (error) {
                console.error('Error:', error);
            }
        }

        // Función para recargar solo la tabla, no la página
        function recargarTabla() {
            generarTabla(); // Recargar la tabla y los gráficos con los nuevos datos
            fetchAndRenderData();
        }

        // Generar la tabla y los gráficos al cargar la página
        document.addEventListener("DOMContentLoaded", function() {
            generarTabla();
            fetchAndRenderData();
        });

    </script>
    
<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

    <script>
        (function() {
            // Esperar hasta que el documento esté completamente cargado
            if (document.readyState === "loading") {
                document.addEventListener("DOMContentLoaded", initObserver);
            } else {
                initObserver();
            }
        
            function initObserver() {
                // Selecciona todas las tablas dinámicas con cuerpo (<tbody>)
                const dynamicTables = document.querySelectorAll("table tbody");
        
                // Observador para detectar cambios en el contenido de las tablas
                const observer = new MutationObserver((mutationsList) => {
                    mutationsList.forEach(mutation => {
                        if (mutation.type === "childList") {
                            const addedRows = Array.from(mutation.addedNodes).filter(node => node.tagName === "TR");
        
                            if (addedRows.length > 0) {
                                // Desactiva temporalmente el observador para evitar ciclos
                                observer.disconnect();
        
                                addedRows.forEach(row => {
                                    if (row.id !== "fixed-row") { // Evita mover la fila principal fija
                                        const tbody = row.closest("tbody");
                                    }
                                });
        
                                // Reactiva el observador
                                dynamicTables.forEach(tbody => observer.observe(tbody, { childList: true }));
                            }
                        }
                    });
                });
        
                // Configuración y activación del observador para cada tabla dinámica
                dynamicTables.forEach(tbody => {
                    observer.observe(tbody, { childList: true });
                });
            }
        })();
    </script>

<!--/* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* *//* */-->

</body>
</html>